<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>QvQ-Ling | QvQ-Ling</title><meta name="author" content="QvQ-Ling"><meta name="copyright" content="QvQ-Ling"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Misc捂住一只耳 音频左声道发现摩斯密码 0010 0100 01 110 00 000 111000 0000 01 0100 0010 001101 010 01 100 00 111 001101 00 10 001101 1001 100 001 解码的flag：moectf{HALF_RADIO_IN_XDU} ez_LSBSteg_Slove进行LSB分离得到  拿到字符串bW9lY">
<meta property="og:type" content="article">
<meta property="og:title" content="QvQ-Ling">
<meta property="og:url" content="https://www.qvq-ling.online/uncategorized/moectf2025/index.html">
<meta property="og:site_name" content="QvQ-Ling">
<meta property="og:description" content="Misc捂住一只耳 音频左声道发现摩斯密码 0010 0100 01 110 00 000 111000 0000 01 0100 0010 001101 010 01 100 00 111 001101 00 10 001101 1001 100 001 解码的flag：moectf{HALF_RADIO_IN_XDU} ez_LSBSteg_Slove进行LSB分离得到  拿到字符串bW9lY">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg">
<meta property="article:published_time" content="2025-08-08T16:00:00.000Z">
<meta property="article:modified_time" content="2025-08-25T08:21:15.605Z">
<meta property="article:author" content="QvQ-Ling">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.qvq-ling.online/uncategorized/moectf2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'QvQ-Ling',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-color: #F5F5F5;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/IMG_20240921_205509.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/Image_1731390906148.jpg" alt="Logo"><span class="site-name">QvQ-Ling</span></a><a class="nav-page-title" href="/"><span class="site-name">QvQ-Ling</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">无标题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-08T16:00:00.000Z" title="发表于 2025-08-09 00:00:00">2025-08-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-25T08:21:15.605Z" title="更新于 2025-08-25 16:21:15">2025-08-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="捂住一只耳"><a href="#捂住一只耳" class="headerlink" title="捂住一只耳"></a>捂住一只耳</h2><p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250809094739538.png" alt="image-20250809094739538"></p>
<p>音频左声道发现摩斯密码</p>
<p>0010 0100 01 110 00 000 111000 0000 01 0100 0010 001101 010 01 100 00 111 001101 00 10 001101 1001 100 001</p>
<p>解码的flag：moectf{HALF_RADIO_IN_XDU}</p>
<h2 id="ez-LSB"><a href="#ez-LSB" class="headerlink" title="ez_LSB"></a>ez_LSB</h2><p>Steg_Slove进行LSB分离得到</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250809103640129.png" alt="image-20250809103640129"></p>
<p>拿到字符串bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R进行base64解码得到flag</p>
<p>moectf{LSB_1s_s0_1nt3rest1ng!!sj9wd}</p>
<h2 id="ez-PNG"><a href="#ez-PNG" class="headerlink" title="ez_PNG"></a>ez_PNG</h2><p>拿到图片放入随波逐流检查无异常</p>
<p>使用binwalk尝试分离文件得到</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250809103826304.png" alt="image-20250809103826304"></p>
<p>其中DB7C7文件中有flag</p>
<p>moectf{h1DdEn_P4YlOaD_IN-Id4T}</p>
<h2 id="Enchantment"><a href="#Enchantment" class="headerlink" title="Enchantment"></a><strong>Enchantment</strong></h2><p>流量分析根据题目提示需要找到一张图片</p>
<p>按长度排序发现png字样</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250823193946123.png" alt="image-20250823193946123"></p>
<p>显示分组字节，另存图片到电脑 </p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250809111048161.png" alt="image-20250809111048161"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/Enchantment.png" alt="Enchantment"></p>
<p>古典密码准银河字母尝试</p>
<p>THEFLAG IS BELOW</p>
<p>NOW_YOU_HAVE_MASTERED_ENCHANTING</p>
<p>moectf{now_you_have_mastered_enchanting}</p>
<h2 id="sstv"><a href="#sstv" class="headerlink" title="sstv"></a>sstv</h2><p>用工具sstvdecoder</p>
<p>方法二：<a target="_blank" rel="noopener" href="https://sstv-decoder.mathieurenaud.fr/">在线 SSTV 解码器 – 将慢速扫描电视音频转换为图像</a></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sstv -d H:\西电<span class="number">2025</span>\sstv.wav -o result.png</span><br></pre></td></tr></table></figure>

<p>获得图片</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250809170423700.png" alt="image-20250809170423700"></p>
<p>moectf{d3codiNG_SStV_reQu1REs-PATI3nC3}</p>
<h2 id="Rush"><a href="#Rush" class="headerlink" title="Rush"></a>Rush</h2><p>分离gif图片 发现图片二维码，截取补全得到flag（我是蠢蛋，直接扫就行）</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-16%20101629.png" alt="屏幕截图 2025-08-16 101629"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-08-16%20104722.png" alt="屏幕截图 2025-08-16 104722"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250816105415988.png" alt="image-20250816105415988"></p>
<h2 id="ez-锟斤拷"><a href="#ez-锟斤拷" class="headerlink" title="ez_锟斤拷"></a>ez_锟斤拷</h2><p><a target="_blank" rel="noopener" href="https://utf8.gongjucha.com/">UTF-8&#x2F;GBK编码在线转换工具</a></p>
<p>了解原理 以 GBK 的方式读取 UTF-8 编码的字符串，再以 UTF-8 的方式重新读取</p>
<p>使用上方软件先进行还原中文后转换utf8得到</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250816114657628.png" alt="image-20250816114657628"></p>
<p>出不来了换个网站</p>
<p><a target="_blank" rel="noopener" href="https://blog.sww.moe/tools/kunjinkao/">锟斤拷生成器</a></p>
<p><img src="C:\Users\Ling\AppData\Roaming\Typora\typora-user-images\image-20250816115727443.png" alt="image-20250816115727443"></p>
<p>直接出了</p>
<p>全角换半角</p>
<p><a target="_blank" rel="noopener" href="https://quanbaojiao.github.org.cn/">文本全角半角在线转换</a></p>
<p>moectf{EnC0d1ing_gbK_@nD_Utf_8_1s_4un!!ewwww}</p>
<h2 id="encrypted-pdf"><a href="#encrypted-pdf" class="headerlink" title="encrypted_pdf"></a>encrypted_pdf</h2><p>用网站删除pdf代码</p>
<p><a target="_blank" rel="noopener" href="https://www.ilovepdf.com/zh-cn/unlock_pdf">解锁 PDF文件。删除PDF文件的保护密码。</a></p>
<p>（passwordkit慢了一步爆破出来密码）</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250816113321055.png" alt="image-20250816113321055"></p>
<p>根据文件内容提示在文档内查找关键字moectf</p>
<p>发现被图片隐藏，编辑pdf文件将图片缩小找到flag</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250816112212518.png" alt="image-20250816112212518"></p>
<h2 id="ez-ssl"><a href="#ez-ssl" class="headerlink" title="ez_ssl"></a>ez_ssl</h2><p>查找流量包发现ssl.log内容，提取出来</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250822134637157.png" alt="image-20250822134637157"></p>
<p>首选项——Protocols——TLS配置ssl.log</p>
<p>再次打开发现flag.zip</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250822141235723.png" alt="image-20250822141235723"></p>
<p>提取zip数据流保存为zip格式</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250822150109964.png" alt="image-20250822150109964"></p>
<p>爆破出密码了</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250822151641669.png" alt="image-20250822151641669"></p>
<p>打开flag.txt发现ook解码</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="入门指北"><a href="#入门指北" class="headerlink" title="入门指北"></a>入门指北</h3><p><strong>题目</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">from Crypto.PublicKey import ElGamal</span><br><span class="line">from Crypto.Random import get_random_bytes, random</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import *</span><br><span class="line">from secret import flag</span><br><span class="line">def generate_elgamal_keypair(bits=512):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    for _ in range(1000):</span><br><span class="line">         g = getRandomRange(2, 5)</span><br><span class="line">         if pow(g, (p - 1) // 2, p) != 1:</span><br><span class="line">            break</span><br><span class="line">    x = randrange(2, p - 1)</span><br><span class="line">    y = pow(g, x, p)</span><br><span class="line">    return p, g, y, x</span><br><span class="line">key=generate_elgamal_keypair(bits=512)</span><br><span class="line">p, g, y ,x= key</span><br><span class="line">print(&quot;=== 公钥 (p, g, y) ===&quot;)</span><br><span class="line">print(&quot;p =&quot;, p)</span><br><span class="line">print(&quot;g =&quot;, g)</span><br><span class="line">print(&quot;y =&quot;, y)</span><br><span class="line">print()</span><br><span class="line">k = randrange(1, p - 2)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c1 = pow(g, k, p)</span><br><span class="line">c2 = (m * pow(y, k, p)) % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p =11540963715962144951763578255357417528966715904849014985547597657698304891044841099894993117258279094910424033273299863589407477091830213468539451196239863</span><br><span class="line">g = 2</span><br><span class="line">y =8313424783366011287014623582773521595333285291380540689467073212212931648415580065207081449784135835711205324186662482526357834042013400765421925274271853</span><br><span class="line">c1 = 6652053553055645358275362259554856525976931841318251152940464543175108560132949610916012490837970851191204144757409335011811874896056430105292534244732863</span><br><span class="line">c2 = 2314913568081526428247981719100952331444938852399031826635475971947484663418362533363591441216570597417789120470703548843342170567039399830377459228297983</span><br><span class="line">x = 8010957078086554284020959664124784479610913596560035011951143269559761229114027738791440961864150225798049120582540951874956255115884539333966429021004214</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>exp</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从输出中提取的参数（注意合并换行的数值）</span></span><br><span class="line">p = <span class="number">11540963715962144951763578255357417528966715904849014985547597657698304891044841099894993117258279094910424033273299863589407477091830213468539451196239863</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">y = <span class="number">8313424783366011287014623582773521595333285291380540689467073212212931648415580065207081449784135835711205324186662482526357834042013400765421925274271853</span></span><br><span class="line">c1 = <span class="number">6652053553055645358275362259554856525976931841318251152940464543175108560132949610916012490837970851191204144757409335011811874896056430105292534244732863</span></span><br><span class="line">c2 = <span class="number">2314913568081526428247981719100952331444938852399031826635475971947484663418362533363591441216570597417789120470703548843342170567039399830377459228297983</span></span><br><span class="line">x = <span class="number">8010957078086554284020959664124784479610913596560035011951143269559761229114027738791440961864150225798049120582540951874956255115884539333966429021004214</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密步骤</span></span><br><span class="line"><span class="comment"># 1. 计算s = c1^x mod p（等价于y^k mod p）</span></span><br><span class="line">s = <span class="built_in">pow</span>(c1, x, p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 计算s的模p逆元</span></span><br><span class="line">s_inv = inverse(s, p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 计算明文m = (c2 * s_inv) mod p</span></span><br><span class="line">m = (c2 * s_inv) % p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 将整数转换为字节，得到flag</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密得到的flag：&quot;</span>, flag.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ez-DES"><a href="#ez-DES" class="headerlink" title="ez_DES"></a>ez_DES</h3><p><strong>题目</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;moectf&#123;???&#125;&#x27;</span></span><br><span class="line">characters = string.ascii_letters + string.digits + string.punctuation</span><br><span class="line">key = <span class="string">&#x27;ezdes&#x27;</span>+<span class="string">&#x27;&#x27;</span>.join(secrets.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>))<span class="comment">#生成8字节密钥</span></span><br><span class="line"><span class="keyword">assert</span> key[:<span class="number">5</span>] == <span class="string">&#x27;ezdes&#x27;</span><span class="comment">#确保前五位是ezdes</span></span><br><span class="line">key = key.encode(<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#将密钥编码为字节</span></span><br><span class="line">l = <span class="number">8</span><span class="comment">#des块大小：8字节</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text, key</span>): </span><br><span class="line">    cipher = DES.new(key, DES.MODE_ECB) <span class="comment">#创建ECB模式的DES加密器</span></span><br><span class="line">    padded_text = text + (l - <span class="built_in">len</span>(text) % l) * <span class="built_in">chr</span>(<span class="built_in">len</span>(text))<span class="comment">#PKCS#7填充</span></span><br><span class="line">    data = cipher.encrypt(padded_text.encode(<span class="string">&#x27;utf-8&#x27;</span>))<span class="comment">#加密</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">c = encrypt(flag, key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;\xe6\x8b0\xc8m\t?\x1d\xf6\x99sA&gt;\xce \rN\x83z\xa0\xdc&#123;\xbc\xb8X\xb2\xe2q\xa4&quot;\xfc\x07&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>**ECB模式：**电子密码本模式，每个块独立加密</p>
<p><strong>Feistel结构</strong>;16轮加密操作</p>
<p><strong>PKCS#7填充</strong></p>
<p>填充规则：添加<code>n</code>个值为<code>n</code>的字节，使总长度为块大小的倍数*如果明文长度37字节（8×4+5），则添加3个值为<code>\x03</code>的字节</p>
<p><strong>exp</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知密文</span></span><br><span class="line">c = <span class="string">b&#x27;\xe6\x8b0\xc8m\t?\x1d\xf6\x99sA&gt;\xce \rN\x83z\xa0\xdc&#123;\xbc\xb8X\xb2\xe2q\xa4&quot;\xfc\x07&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥的字符集（与加密时一致）</span></span><br><span class="line">characters = string.ascii_letters + string.digits + string.punctuation</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    <span class="comment"># 创建DES解密器（ECB模式）</span></span><br><span class="line">    cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">    <span class="comment"># 解密得到填充后的明文字节</span></span><br><span class="line">    padded_bytes = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">return</span> padded_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历所有可能的密钥（ezdes + 3个字符）</span></span><br><span class="line"><span class="keyword">for</span> c1 <span class="keyword">in</span> characters:</span><br><span class="line">    <span class="keyword">for</span> c2 <span class="keyword">in</span> characters:</span><br><span class="line">        <span class="keyword">for</span> c3 <span class="keyword">in</span> characters:</span><br><span class="line">            <span class="comment"># 生成密钥</span></span><br><span class="line">            key_str = <span class="string">f&quot;ezdes<span class="subst">&#123;c1&#125;</span><span class="subst">&#123;c2&#125;</span><span class="subst">&#123;c3&#125;</span>&quot;</span></span><br><span class="line">            key = key_str.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 解密</span></span><br><span class="line">            padded_bytes = decrypt(c, key)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 尝试解码为字符串（处理可能的编码错误）</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                padded_text = padded_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 验证填充规则</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> padded_text:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 填充字符是最后一个字符（填充部分的所有字符相同）</span></span><br><span class="line">            pad_char = padded_text[-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                original_length = <span class="built_in">ord</span>(pad_char)  <span class="comment"># 原始明文长度</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            flag_candidate = padded_text[:original_length]</span><br><span class="line">            <span class="comment"># 验证flag格式（moectf&#123;...&#125;）</span></span><br><span class="line">            <span class="keyword">if</span> flag_candidate.startswith(<span class="string">&#x27;moectf&#123;&#x27;</span>) <span class="keyword">and</span> flag_candidate.endswith(<span class="string">&#x27;&#125;&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;找到flag: <span class="subst">&#123;flag_candidate&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;对应密钥: <span class="subst">&#123;key_str&#125;</span>&quot;</span>)</span><br><span class="line">                exit()  <span class="comment"># 找到后退出</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ez-square"><a href="#ez-square" class="headerlink" title="ez_square"></a>ez_square</h3><p><strong>题目</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">35</span></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">7</span>] == <span class="string">b&#x27;moectf&#123;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> flag[-<span class="number">1</span>:] == <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    hint = <span class="built_in">pow</span>(p + q, <span class="number">2</span>, n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">83917281059209836833837824007690691544699901753577294450739161840987816051781770716778159151802639720854808886223999296102766845876403271538287419091422744267873129896312388567406645946985868002735024896571899580581985438021613509956651683237014111116217116870686535030557076307205101926450610365611263289149</span></span><br><span class="line">c = <span class="number">69694813399964784535448926320621517155870332267827466101049186858004350675634768405333171732816667487889978017750378262941788713673371418944090831542155613846263236805141090585331932145339718055875857157018510852176248031272419248573911998354239587587157830782446559008393076144761176799690034691298870022190</span></span><br><span class="line">hint = <span class="number">5491796378615699391870545352353909903258578093592392113819670099563278086635523482350754035015775218028095468852040957207028066409846581454987397954900268152836625448524886929236711403732984563866312512753483333102094024510204387673875968726154625598491190530093961973354413317757182213887911644502704780304</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知参数</span></span><br><span class="line">n = <span class="number">83917281059209836833837824007690691544699901753577294450739161840987816051781770716778159151802639720854808886223999296102766845876403271538287419091422744267873129896312388567406645946985868002735024896571899580581985438021613509956651683237014111116217116870686535030557076307205101926450610365611263289149</span></span><br><span class="line">c = <span class="number">69694813399964784535448926320621517155870332267827466101049186858004350675634768405333171732816667487889978017750378262941788713673371418944090831542155613846263236805141090585331932145339718055875857157018510852176248031272419248573911998354239587587157830782446559008393076144761176799690034691298870022190</span></span><br><span class="line">hint = <span class="number">5491796378615699391870545352353909903258578093592392113819670099563278086635523482350754035015775218028095468852040957207028066409846581454987397954900268152836625448524886929236711403732984563866312512753483333102094024510204387673875968726154625598491190530093961973354413317757182213887911644502704780304</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算hint的平方根h</span></span><br><span class="line">h, is_perfect = gmpy2.iroot(hint, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> is_perfect, <span class="string">&quot;hint不是完全平方数，无法继续&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试可能的k值，还原s = p+q</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>):  <span class="comment"># 尝试小范围的k值</span></span><br><span class="line">    s_squared = hint + k * n  <span class="comment"># s² = (p+q)² = hint + k*n（因hint是模n的结果）</span></span><br><span class="line">    s, is_s = gmpy2.iroot(s_squared, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_s:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># s不是整数，跳过</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 验证p和q是否存在：二次方程判别式需为完全平方</span></span><br><span class="line">    discriminant = s * s - <span class="number">4</span> * n  <span class="comment"># 判别式D = (p-q)²</span></span><br><span class="line">    t, is_t = gmpy2.iroot(discriminant, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_t:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 判别式不是完全平方，跳过</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 确保p和q为整数（s和t奇偶性一致）</span></span><br><span class="line">    <span class="keyword">if</span> (s + t) % <span class="number">2</span> != <span class="number">0</span> <span class="keyword">or</span> (s - t) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算p和q并验证</span></span><br><span class="line">    p = (s + t) // <span class="number">2</span></span><br><span class="line">    q = (s - t) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> p * q != n:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 验证不通过，跳过</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算私钥d并解密</span></span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;找到p和q：\np = <span class="subst">&#123;p&#125;</span>\nq = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密得到flag：<span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;未找到有效解&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="ezlegendre"><a href="#ezlegendre" class="headerlink" title="ezlegendre"></a>ezlegendre</h3><p><strong>题目</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">258669765135238783146000574794031096183</span></span><br><span class="line">a = <span class="number">144901483389896508632771215712413815934</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">flag</span>):</span><br><span class="line">    ciphertext = []</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag])</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> plaintext:</span><br><span class="line">        e = getPrime(<span class="number">16</span>)</span><br><span class="line">        d = randint(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">        n = <span class="built_in">pow</span>(a+<span class="built_in">int</span>(b)*d, e, p)</span><br><span class="line">        ciphertext.append(n)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt_flag(flag))</span><br><span class="line">flag=[<span class="number">102230607782303286066661803375943337852</span>, <span class="number">196795077203291879584123548614536291210</span>, <span class="number">41820965969318717978206410470942308653</span>, <span class="number">207485265608553973031638961376379316991</span>, <span class="number">126241934830164184030184483965965358511</span>, <span class="number">20250852993510047910828861636740192486</span>, <span class="number">103669039044817273633962139070912140023</span>, <span class="number">97337342479349334554052986501856387313</span>, <span class="number">159127719377115088432849153087501377529</span>, <span class="number">45764236700940832554086668329121194445</span>, <span class="number">35275004033464216369574866255836768148</span>, <span class="number">52905563179465420745275423120979831405</span>, <span class="number">17032180473319795641143474346227445013</span>, <span class="number">29477780450507011415073117531375947096</span>, <span class="number">55487351149573346854028771906741727601</span>, <span class="number">121576510894250531063152466107000055279</span>, <span class="number">69959515052241122548546701060784004682</span>, <span class="number">173839335744520746760315021378911211216</span>, <span class="number">28266103662329817802592951699263023295</span>, <span class="number">194965730205655016437216590690038884309</span>, <span class="number">208284966254343254016582889051763066574</span>, <span class="number">137680272193449000169293006333866420934</span>, <span class="number">250634504150859449051246497912830488025</span>, <span class="number">124228075953362483108097926850143387433</span>, <span class="number">232956176229023369857830577971626577196</span>, <span class="number">149441784891021006224395235471825205661</span>, <span class="number">118758326165875568431376314508740278934</span>, <span class="number">222296215466271835013184903421917936512</span>, <span class="number">49132466023594939909761224481560782731</span>, <span class="number">406286678537520849308828749751513339</span>, <span class="number">215122152883292859254246948661946520324</span>, <span class="number">81283590250399459209567683991648438199</span>, <span class="number">150395133067480380674905743031927410663</span>, <span class="number">5710878479977467762548400320726575491</span>, <span class="number">83627753774286426170934105100463456109</span>, <span class="number">164968224377869331545649899270867630850</span>, <span class="number">241057183685774160581265732812497247167</span>, <span class="number">109136287048010096863680430193408099828</span>, <span class="number">116313129605409961931811582899075031153</span>, <span class="number">202739016625709380026000805340243458300</span>, <span class="number">25408225921774957745573142542576755590</span>, <span class="number">151336258796933656160956289529558246702</span>, <span class="number">2947189044370494063643525166023973095</span>, <span class="number">228678413963736672394976193093568181979</span>, <span class="number">40627063032321835707220414670018641024</span>, <span class="number">55446789315226949622969082042881319148</span>, <span class="number">32219108726651509070669836923591948459</span>, <span class="number">134454924722414419191920784435633637634</span>, <span class="number">97952023967728640730045857104376826039</span>, <span class="number">20659076942504417479953787092276592682</span>, <span class="number">93281761173713729777326842152860901050</span>, <span class="number">133634773495582264000160065317239987936</span>, <span class="number">79976720152435218818731114555425458470</span>, <span class="number">234654694673289327542859971371886984118</span>, <span class="number">51332273108989067644245919615090753756</span>, <span class="number">134120280423303717489979349737802826605</span>, <span class="number">182001158305920226320085758522717203725</span>, <span class="number">98408798757865562737462169470346158516</span>, <span class="number">78200435603900368619334272308272773797</span>, <span class="number">232796357836930341547987600782979821555</span>, <span class="number">589106968861493082018132081244848952</span>, <span class="number">24186003230092331554886767628744415123</span>, <span class="number">236070626491251466741246103662922841423</span>, <span class="number">238699080882667864827094121849090696547</span>, <span class="number">141659873734297659078160283051728812410</span>, <span class="number">228977113517120063860252637394240795552</span>, <span class="number">236613527842969921794004708284265628300</span>, <span class="number">145522034982744654991661857596541755396</span>, <span class="number">249608374387044047328725156440984678776</span>, <span class="number">325110572051913836681821746093704556</span>, <span class="number">171492052199838424502681030556098576483</span>, <span class="number">156498865212994371079795360268866413702</span>, <span class="number">196747701509389071931992996873572785043</span>, <span class="number">70811811603137896158765356680364490781</span>, <span class="number">83672551582385607422240464086955462541</span>, <span class="number">117961603623637997457153763936550310698</span>, <span class="number">224448821395214505399297116719025174412</span>, <span class="number">4598815373009554321735225938200807251</span>, <span class="number">194892269604260726530091473301914449005</span>, <span class="number">127484628022155760909820605666827662175</span>, <span class="number">208706240846212140439291547368645656474</span>, <span class="number">14102286481104997303651684152195298336</span>, <span class="number">6129503335471304345451795609683770657</span>, <span class="number">103799668048593149396277157385628834185</span>, <span class="number">185813375481410513002496683918106238351</span>, <span class="number">233491689316882978147517340230794025796</span>, <span class="number">46274083097168831187719988888816378961</span>, <span class="number">119487551553664772614629936285345836934</span>, <span class="number">84340029922118279362389419277915602509</span>, <span class="number">88253743193124528032223101368846247085</span>, <span class="number">227895357640018330099501504941388167432</span>, <span class="number">92189947144174433744195727086236905626</span>, <span class="number">83114957902192791332190922428847199876</span>, <span class="number">173535754090441937731619031520699325122</span>, <span class="number">192309407933789484835602071782330798398</span>, <span class="number">255421921600128994923738650157598053776</span>, <span class="number">155535082468314012733563336837641958625</span>, <span class="number">49064798421022327310707074253263463055</span>, <span class="number">161216416471071644769301963857685054031</span>, <span class="number">252480348817188872515008985698620059851</span>, <span class="number">75854882798183185741756645038434215611</span>, <span class="number">256065006192683011190132982128640682537</span>, <span class="number">87507510173514424105732562474643251223</span>, <span class="number">163309795132131534875147566536485288212</span>, <span class="number">253583084320404985699510129361746869059</span>, <span class="number">253300112521651972637580307326576568313</span>, <span class="number">239027717080729650738678032571840680727</span>, <span class="number">117444657686971615526398894470673026034</span>, <span class="number">215470942802874046857958621181684551426</span>, <span class="number">58767098748728136687851735836323448020</span>, <span class="number">249357164697409977883764098879705065535</span>, <span class="number">174705348385893117518084017669958647345</span>, <span class="number">211108767177375215605155301209259781232</span>, <span class="number">57829566748907062397366819001461941421</span>, <span class="number">88265742700024922112974862134385921564</span>, <span class="number">80952107622167923709226013231566882261</span>, <span class="number">236078582132483864916117213281193714198</span>, <span class="number">193448482646563141692726575550417225891</span>, <span class="number">245972799166806058223048506073553726233</span>, <span class="number">10132977708896091601871557249244373666</span>, <span class="number">201785418152654519825849206312616081028</span>, <span class="number">15169816744048531212384271865884567710</span>, <span class="number">122545328290385950043826822277924297182</span>, <span class="number">202918646192255177261567701479991753600</span>, <span class="number">32696887488223731055835744711207261936</span>, <span class="number">88319352182963224921157305627381030375</span>, <span class="number">92381505322264045777004475690398861771</span>, <span class="number">189745654013352563126968415157143821842</span>, <span class="number">152254915005998949299817641843658795579</span>, <span class="number">198032433618991362619448347415342295581</span>, <span class="number">84073892809321676935569114878067118319</span>, <span class="number">82243805869584256211699602267760745768</span>, <span class="number">61994229948266781537191603999495995852</span>, <span class="number">253668765227759797787675352833142466255</span>, <span class="number">38865376724677211964966907748953557125</span>, <span class="number">134615436811268347303232550777225944929</span>, <span class="number">176932422465426107783498083830285780588</span>, <span class="number">207573742393618910694054452362826628208</span>, <span class="number">200033130835394442710748301293534928706</span>, <span class="number">127536063935293533700918451145963158658</span>, <span class="number">219125698281820710910675956971948816959</span>, <span class="number">179795893258398750139395156587561075767</span>, <span class="number">69649628109726874051635160004398498964</span>, <span class="number">241433717681314766463039563422535023524</span>, <span class="number">202664264135718511331695232476272832350</span>, <span class="number">205151096657425932591242432052912914182</span>, <span class="number">210305712465948130683966275157181140301</span>, <span class="number">196555690055906934925300527324955477733</span>, <span class="number">66817932643964538216259564711698986077</span>, <span class="number">95270796440975607179107356182889534333</span>, <span class="number">123226880424532374188134357659879826495</span>, <span class="number">53506495440223773538415807620524749240</span>, <span class="number">19253217887083870834249774316467647628</span>, <span class="number">165699356396365023442008488156823647206</span>, <span class="number">107809175498119862854792975070673056027</span>, <span class="number">250453989887421415931162217952559757164</span>, <span class="number">171492052199838424502681030556098576483</span>, <span class="number">133778166882550119563444625306816232463</span>, <span class="number">149009301604122447269581792013291889175</span>, <span class="number">9982418254629616281350713836647603294</span>, <span class="number">203486292122499140756846060502464655972</span>, <span class="number">157686696123400087437836943220926921848</span>, <span class="number">88338919773540412238116717043122711811</span>, <span class="number">113265824169274322024623493892867211478</span>, <span class="number">5549372099744960679418616304893848801</span>, <span class="number">12431828907518852062050349123660880165</span>, <span class="number">183957934738536914983862053251433028750</span>, <span class="number">42027289270308356303682029801998790750</span>, <span class="number">117406080036483925915502666019795783905</span>, <span class="number">154312255292300186042636734144948304054</span>, <span class="number">143706917273862261295046346995206133170</span>, <span class="number">50088136095338601440516112338120787526</span>, <span class="number">250634504150859449051246497912830488025</span>, <span class="number">8073010289877796888705519374892639903</span>, <span class="number">40049582814576788803483039836229025416</span>, <span class="number">227012342545923833983403067401561291645</span>, <span class="number">201776603581414625783054400184026088994</span>, <span class="number">55474945478884522762318445841998187357</span>, <span class="number">221515530211550293408010846844218019597</span>, <span class="number">172650752042211610909190315288155597255</span>, <span class="number">67046194931321172530462444254204111483</span>, <span class="number">207435868835185636819659137800256834557</span>, <span class="number">188063222224545200294767050268070647452</span>, <span class="number">58099349021260301211275261896736590564</span>, <span class="number">23598877596106927870697531042828774738</span>, <span class="number">58546308516383335224739442370238545000</span>, <span class="number">58125311541947998710088435169901475101</span>, <span class="number">238219925698115060748249043752036454438</span>, <span class="number">203910234934340893915761800653823457631</span>, <span class="number">190854889967769152565565000250829375099</span>, <span class="number">37573623890629846209257307181880876288</span>, <span class="number">226220240200270623843038279593586687278</span>, <span class="number">144246075981535671790438155977352345487</span>, <span class="number">14665770553338784222331493932533448756</span>, <span class="number">37992062606775322664977502677838074649</span>, <span class="number">47370175759976523832233910009306151684</span>, <span class="number">97047813247943880266351445874642842468</span>, <span class="number">237607444658797800072728280983357541134</span>, <span class="number">174853113478993738890584814806707459112</span>, <span class="number">17104608155861584438824639050715857607</span>, <span class="number">83639027011494777283064583268678718843</span>, <span class="number">237826165608708003941944469905843354705</span>, <span class="number">231707683915242052796886276983724691027</span>, <span class="number">146089830852925550139294146760718642221</span>, <span class="number">25604562707667550478623425477029052785</span>, <span class="number">108577663147976992047614498924706939204</span>, <span class="number">69040319834829375335287614995435269276</span>, <span class="number">169933229202934375632745753379104389929</span>, <span class="number">72693008284867494808267387710985847974</span>, <span class="number">158548279589965576940349068403862889270</span>, <span class="number">49458101234256610254825879149914255140</span>, <span class="number">24389558269688411084589654047215902968</span>, <span class="number">210567980379246548727819953025607019254</span>, <span class="number">110423375132252997825868399832298953831</span>, <span class="number">109589895677661968369424757992411668628</span>, <span class="number">66177577069199763925999718357846633613</span>, <span class="number">83602293803708828242273186265396676466</span>, <span class="number">172226271050176278536911356541786290551</span>, <span class="number">85799805809703976643034084477579915867</span>, <span class="number">179399990302447560847151603157937241688</span>, <span class="number">81687654752229170984692833277072534294</span>, <span class="number">160766441640281044008645821822296569868</span>, <span class="number">100306680611749750243920501921769642984</span>, <span class="number">42195187332833922597871030332905266026</span>, <span class="number">238918420772178508359295233180536910768</span>, <span class="number">221685929158944699801776621298532178665</span>, <span class="number">209349638787804999657456057184702655805</span>, <span class="number">183953393268431043006359511952782903516</span>, <span class="number">137364333131365794683132159746962959967</span>, <span class="number">15637689373906596015395350692459218048</span>, <span class="number">145956368418289159411911667337899986262</span>, <span class="number">197987711355277581048877821432652325207</span>, <span class="number">125421308989313724733467092345532539875</span>, <span class="number">90525081516582408488547894471421476595</span>, <span class="number">107405840115256692042814887586009104950</span>, <span class="number">71587500700172519801649824611045199280</span>, <span class="number">10155721246869986043302768283257682883</span>, <span class="number">100522792569358427133597834727509523742</span>, <span class="number">244473925018526409824670892423775482110</span>, <span class="number">50746138425761666610345252577572889037</span>, <span class="number">142188269919422432629363225167297071042</span>, <span class="number">8235113926890598897465093754260801947</span>, <span class="number">174540885017405784646782293055852044631</span>, <span class="number">171949847901434672429841435895697323702</span>, <span class="number">34391199559497599434575002007581170988</span>, <span class="number">7337868660819385932166025474594964373</span>, <span class="number">89608475952042154068811282935241824949</span>, <span class="number">162561097613906905390170334328135062933</span>, <span class="number">252566077272083954707900007055640560669</span>, <span class="number">4284637988579219107997224848114896904</span>, <span class="number">220026371387782427901244689037957398829</span>, <span class="number">86019060485320999498155965142619258089</span>, <span class="number">19304861731281576405798605142335886482</span>, <span class="number">123188238667151068575810494833929221938</span>, <span class="number">125089740978532716086813732154638565196</span>, <span class="number">252061524500088702951562270741214799294</span>, <span class="number">89528875472312768404823823905699760649</span>, <span class="number">63307407053590054220492282094909190524</span>, <span class="number">24389558269688411084589654047215902968</span>, <span class="number">43835777110183833958990705735152973942</span>, <span class="number">196543204310466258426232803779025620993</span>, <span class="number">225032412767857179129234169288824097261</span>, <span class="number">50292890880286260984317361296226049436</span>, <span class="number">64928956886509273090981701066528078331</span>, <span class="number">25408225921774957745573142542576755590</span>, <span class="number">235921667882292842303120860570747218086</span>, <span class="number">217132603855089441017750752624514343437</span>, <span class="number">11106129204256119599329380588789107048</span>, <span class="number">147501327490657927610543345089238991876</span>, <span class="number">158091159632919983870444592039392730373</span>, <span class="number">254215886971254771885657857148535673338</span>, <span class="number">129869106474614345624950211566868568809</span>, <span class="number">10425702332274469498479699675668087022</span>, <span class="number">136595953187315682777976356839442311764</span>, <span class="number">1607792140397737044118662059498732982</span>, <span class="number">23710000155612873207506044342091514799</span>, <span class="number">118571340370877720354330132780832828911</span>, <span class="number">194624784476702188629452374731837038856</span>, <span class="number">51332273108989067644245919615090753756</span>, <span class="number">240921043405288511960365826273938845156</span>, <span class="number">158670188709175825212687487436006138030</span>, <span class="number">133641825913283256858340618209700716053</span>, <span class="number">43054466484232130048301271684438593412</span>, <span class="number">20361972967806283315536154125012604660</span>, <span class="number">135700832615866572032111395529532615300</span>, <span class="number">160609169788639387827865051539103507016</span>, <span class="number">100576279475451993660766480883708996211</span>, <span class="number">215424685541583305069271024253690375127</span>, <span class="number">60018956375784961551937423504137141702</span>, <span class="number">107997941230633604720421526632224279451</span>, <span class="number">219482010609171816035007605036664317041</span>, <span class="number">22173526221024380740269311947729076493</span>, <span class="number">249746554302052221287371350978970766087</span>, <span class="number">93207359085331319264650563354951254906</span>, <span class="number">221421697282310997113867048083058096452</span>, <span class="number">61834092635779365101011109381392037516</span>, <span class="number">162215218701897689647766394615098617152</span>, <span class="number">141856131587452385513407955541400099703</span>, <span class="number">177910903795887762773545874929605680469</span>, <span class="number">228832704523723308335513552177377803295</span>, <span class="number">229427981969125094398744034150988525118</span>, <span class="number">217938760689082034514008764751385239765</span>, <span class="number">3238055163645731541423094980789895030</span>, <span class="number">42308449860804765793467328093112118974</span>, <span class="number">254764518926620089428032312378507653680</span>, <span class="number">215733901156118606036318409454786603209</span>, <span class="number">59640829345183339336712595595022506261</span>, <span class="number">33515071724475649656070325837411550208</span>, <span class="number">51175659069843551646353202764296812462</span>, <span class="number">211462959696081863041546889096760952490</span>, <span class="number">230559603938699838189391087728971115767</span>, <span class="number">85878911733601049548471257838175175563</span>, <span class="number">214134904074265214033878852207103328297</span>, <span class="number">160702405980652445507529591230654474171</span>, <span class="number">223755040649990285320102091954198427148</span>, <span class="number">166476753890268002826149533120107157745</span>, <span class="number">26283916639129998224675164834425763384</span>, <span class="number">232971495542024495583092055361321729894</span>, <span class="number">79741799146769724681649849525636816379</span>, <span class="number">228506526471280046809909301748098760369</span>, <span class="number">167502422063741368765891061653686283332</span>, <span class="number">26984184590668253713951516794937308166</span>, <span class="number">105952393031190074432183821281493254</span>, <span class="number">113823192955281698937767041115166174652</span>, <span class="number">93264047694114869263275726820602569731</span>, <span class="number">55481974783112950660682138071588408040</span>, <span class="number">108961894273530837550182447112767144669</span>, <span class="number">47975793549419083945738147934068241928</span>, <span class="number">204024371586357035343484206754422857590</span>, <span class="number">251859351272989525849999231358507018068</span>, <span class="number">75939709807860493804628805619699991501</span>, <span class="number">129031774446142139804436921156668129187</span>, <span class="number">110764318451937254261883856778359218969</span>, <span class="number">246404864722813298477426808193494673610</span>, <span class="number">153818236564405157581869620439634140065</span>, <span class="number">246125932167584353084676586883038397451</span>]</span><br></pre></td></tr></table></figure>

<p><strong>exp</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知参数</span></span><br><span class="line">p = <span class="number">258669765135238783146000574794031096183</span></span><br><span class="line">a = <span class="number">144901483389896508632771215712413815934</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成所有16位质数（e的可能取值）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_16bit_primes</span>():</span><br><span class="line">    primes = []</span><br><span class="line">    <span class="comment"># 16位质数范围：2到65535之间的质数</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">65536</span>):</span><br><span class="line">        <span class="keyword">if</span> isPrime(num):</span><br><span class="line">            primes.append(num)</span><br><span class="line">    <span class="keyword">return</span> primes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有可能的e值</span></span><br><span class="line">possible_e = get_16bit_primes()</span><br><span class="line">ciphertext = [<span class="number">102230607782303286066661803375943337852</span>, <span class="number">196795077203291879584123548614536291210</span>, <span class="number">41820965969318717978206410470942308653</span>, <span class="number">207485265608553973031638961376379316991</span>, <span class="number">126241934830164184030184483965965358511</span>, <span class="number">20250852993510047910828861636740192486</span>, <span class="number">103669039044817273633962139070912140023</span>, <span class="number">97337342479349334554052986501856387313</span>, <span class="number">159127719377115088432849153087501377529</span>, <span class="number">45764236700940832554086668329121194445</span>, <span class="number">35275004033464216369574866255836768148</span>, <span class="number">52905563179465420745275423120979831405</span>, <span class="number">17032180473319795641143474346227445013</span>, <span class="number">29477780450507011415073117531375947096</span>, <span class="number">55487351149573346854028771906741727601</span>, <span class="number">121576510894250531063152466107000055279</span>, <span class="number">69959515052241122548546701060784004682</span>, <span class="number">173839335744520746760315021378911211216</span>, <span class="number">28266103662329817802592951699263023295</span>, <span class="number">194965730205655016437216590690038884309</span>, <span class="number">208284966254343254016582889051763066574</span>, <span class="number">137680272193449000169293006333866420934</span>, <span class="number">250634504150859449051246497912830488025</span>, <span class="number">124228075953362483108097926850143387433</span>, <span class="number">232956176229023369857830577971626577196</span>, <span class="number">149441784891021006224395235471825205661</span>, <span class="number">118758326165875568431376314508740278934</span>, <span class="number">222296215466271835013184903421917936512</span>, <span class="number">49132466023594939909761224481560782731</span>, <span class="number">406286678537520849308828749751513339</span>, <span class="number">215122152883292859254246948661946520324</span>, <span class="number">81283590250399459209567683991648438199</span>, <span class="number">150395133067480380674905743031927410663</span>, <span class="number">5710878479977467762548400320726575491</span>, <span class="number">83627753774286426170934105100463456109</span>, <span class="number">164968224377869331545649899270867630850</span>, <span class="number">241057183685774160581265732812497247167</span>, <span class="number">109136287048010096863680430193408099828</span>, <span class="number">116313129605409961931811582899075031153</span>, <span class="number">202739016625709380026000805340243458300</span>, <span class="number">25408225921774957745573142542576755590</span>, <span class="number">151336258796933656160956289529558246702</span>, <span class="number">2947189044370494063643525166023973095</span>, <span class="number">228678413963736672394976193093568181979</span>, <span class="number">40627063032321835707220414670018641024</span>, <span class="number">55446789315226949622969082042881319148</span>, <span class="number">32219108726651509070669836923591948459</span>, <span class="number">134454924722414419191920784435633637634</span>, <span class="number">97952023967728640730045857104376826039</span>, <span class="number">20659076942504417479953787092276592682</span>, <span class="number">93281761173713729777326842152860901050</span>, <span class="number">133634773495582264000160065317239987936</span>, <span class="number">79976720152435218818731114555425458470</span>, <span class="number">234654694673289327542859971371886984118</span>, <span class="number">51332273108989067644245919615090753756</span>, <span class="number">134120280423303717489979349737802826605</span>, <span class="number">182001158305920226320085758522717203725</span>, <span class="number">98408798757865562737462169470346158516</span>, <span class="number">78200435603900368619334272308272773797</span>, <span class="number">232796357836930341547987600782979821555</span>, <span class="number">589106968861493082018132081244848952</span>, <span class="number">24186003230092331554886767628744415123</span>, <span class="number">236070626491251466741246103662922841423</span>, <span class="number">238699080882667864827094121849090696547</span>, <span class="number">141659873734297659078160283051728812410</span>, <span class="number">228977113517120063860252637394240795552</span>, <span class="number">236613527842969921794004708284265628300</span>, <span class="number">145522034982744654991661857596541755396</span>, <span class="number">249608374387044047328725156440984678776</span>, <span class="number">325110572051913836681821746093704556</span>, <span class="number">171492052199838424502681030556098576483</span>, <span class="number">156498865212994371079795360268866413702</span>, <span class="number">196747701509389071931992996873572785043</span>, <span class="number">70811811603137896158765356680364490781</span>, <span class="number">83672551582385607422240464086955462541</span>, <span class="number">117961603623637997457153763936550310698</span>, <span class="number">224448821395214505399297116719025174412</span>, <span class="number">4598815373009554321735225938200807251</span>, <span class="number">194892269604260726530091473301914449005</span>, <span class="number">127484628022155760909820605666827662175</span>, <span class="number">208706240846212140439291547368645656474</span>, <span class="number">14102286481104997303651684152195298336</span>, <span class="number">6129503335471304345451795609683770657</span>, <span class="number">103799668048593149396277157385628834185</span>, <span class="number">185813375481410513002496683918106238351</span>, <span class="number">233491689316882978147517340230794025796</span>, <span class="number">46274083097168831187719988888816378961</span>, <span class="number">119487551553664772614629936285345836934</span>, <span class="number">84340029922118279362389419277915602509</span>, <span class="number">88253743193124528032223101368846247085</span>, <span class="number">227895357640018330099501504941388167432</span>, <span class="number">92189947144174433744195727086236905626</span>, <span class="number">83114957902192791332190922428847199876</span>, <span class="number">173535754090441937731619031520699325122</span>, <span class="number">192309407933789484835602071782330798398</span>, <span class="number">255421921600128994923738650157598053776</span>, <span class="number">155535082468314012733563336837641958625</span>, <span class="number">49064798421022327310707074253263463055</span>, <span class="number">161216416471071644769301963857685054031</span>, <span class="number">252480348817188872515008985698620059851</span>, <span class="number">75854882798183185741756645038434215611</span>, <span class="number">256065006192683011190132982128640682537</span>, <span class="number">87507510173514424105732562474643251223</span>, <span class="number">163309795132131534875147566536485288212</span>, <span class="number">253583084320404985699510129361746869059</span>, <span class="number">253300112521651972637580307326576568313</span>, <span class="number">239027717080729650738678032571840680727</span>, <span class="number">117444657686971615526398894470673026034</span>, <span class="number">215470942802874046857958621181684551426</span>, <span class="number">58767098748728136687851735836323448020</span>, <span class="number">249357164697409977883764098879705065535</span>, <span class="number">174705348385893117518084017669958647345</span>, <span class="number">211108767177375215605155301209259781232</span>, <span class="number">57829566748907062397366819001461941421</span>, <span class="number">88265742700024922112974862134385921564</span>, <span class="number">80952107622167923709226013231566882261</span>, <span class="number">236078582132483864916117213281193714198</span>, <span class="number">193448482646563141692726575550417225891</span>, <span class="number">245972799166806058223048506073553726233</span>, <span class="number">10132977708896091601871557249244373666</span>, <span class="number">201785418152654519825849206312616081028</span>, <span class="number">15169816744048531212384271865884567710</span>, <span class="number">122545328290385950043826822277924297182</span>, <span class="number">202918646192255177261567701479991753600</span>, <span class="number">32696887488223731055835744711207261936</span>, <span class="number">88319352182963224921157305627381030375</span>, <span class="number">92381505322264045777004475690398861771</span>, <span class="number">189745654013352563126968415157143821842</span>, <span class="number">152254915005998949299817641843658795579</span>, <span class="number">198032433618991362619448347415342295581</span>, <span class="number">84073892809321676935569114878067118319</span>, <span class="number">82243805869584256211699602267760745768</span>, <span class="number">61994229948266781537191603999495995852</span>, <span class="number">253668765227759797787675352833142466255</span>, <span class="number">38865376724677211964966907748953557125</span>, <span class="number">134615436811268347303232550777225944929</span>, <span class="number">176932422465426107783498083830285780588</span>, <span class="number">207573742393618910694054452362826628208</span>, <span class="number">200033130835394442710748301293534928706</span>, <span class="number">127536063935293533700918451145963158658</span>, <span class="number">219125698281820710910675956971948816959</span>, <span class="number">179795893258398750139395156587561075767</span>, <span class="number">69649628109726874051635160004398498964</span>, <span class="number">241433717681314766463039563422535023524</span>, <span class="number">202664264135718511331695232476272832350</span>, <span class="number">205151096657425932591242432052912914182</span>, <span class="number">210305712465948130683966275157181140301</span>, <span class="number">196555690055906934925300527324955477733</span>, <span class="number">66817932643964538216259564711698986077</span>, <span class="number">95270796440975607179107356182889534333</span>, <span class="number">123226880424532374188134357659879826495</span>, <span class="number">53506495440223773538415807620524749240</span>, <span class="number">19253217887083870834249774316467647628</span>, <span class="number">165699356396365023442008488156823647206</span>, <span class="number">107809175498119862854792975070673056027</span>, <span class="number">250453989887421415931162217952559757164</span>, <span class="number">171492052199838424502681030556098576483</span>, <span class="number">133778166882550119563444625306816232463</span>, <span class="number">149009301604122447269581792013291889175</span>, <span class="number">9982418254629616281350713836647603294</span>, <span class="number">203486292122499140756846060502464655972</span>, <span class="number">157686696123400087437836943220926921848</span>, <span class="number">88338919773540412238116717043122711811</span>, <span class="number">113265824169274322024623493892867211478</span>, <span class="number">5549372099744960679418616304893848801</span>, <span class="number">12431828907518852062050349123660880165</span>, <span class="number">183957934738536914983862053251433028750</span>, <span class="number">42027289270308356303682029801998790750</span>, <span class="number">117406080036483925915502666019795783905</span>, <span class="number">154312255292300186042636734144948304054</span>, <span class="number">143706917273862261295046346995206133170</span>, <span class="number">50088136095338601440516112338120787526</span>, <span class="number">250634504150859449051246497912830488025</span>, <span class="number">8073010289877796888705519374892639903</span>, <span class="number">40049582814576788803483039836229025416</span>, <span class="number">227012342545923833983403067401561291645</span>, <span class="number">201776603581414625783054400184026088994</span>, <span class="number">55474945478884522762318445841998187357</span>, <span class="number">221515530211550293408010846844218019597</span>, <span class="number">172650752042211610909190315288155597255</span>, <span class="number">67046194931321172530462444254204111483</span>, <span class="number">207435868835185636819659137800256834557</span>, <span class="number">188063222224545200294767050268070647452</span>, <span class="number">58099349021260301211275261896736590564</span>, <span class="number">23598877596106927870697531042828774738</span>, <span class="number">58546308516383335224739442370238545000</span>, <span class="number">58125311541947998710088435169901475101</span>, <span class="number">238219925698115060748249043752036454438</span>, <span class="number">203910234934340893915761800653823457631</span>, <span class="number">190854889967769152565565000250829375099</span>, <span class="number">37573623890629846209257307181880876288</span>, <span class="number">226220240200270623843038279593586687278</span>, <span class="number">144246075981535671790438155977352345487</span>, <span class="number">14665770553338784222331493932533448756</span>, <span class="number">37992062606775322664977502677838074649</span>, <span class="number">47370175759976523832233910009306151684</span>, <span class="number">97047813247943880266351445874642842468</span>, <span class="number">237607444658797800072728280983357541134</span>, <span class="number">174853113478993738890584814806707459112</span>, <span class="number">17104608155861584438824639050715857607</span>, <span class="number">83639027011494777283064583268678718843</span>, <span class="number">237826165608708003941944469905843354705</span>, <span class="number">231707683915242052796886276983724691027</span>, <span class="number">146089830852925550139294146760718642221</span>, <span class="number">25604562707667550478623425477029052785</span>, <span class="number">108577663147976992047614498924706939204</span>, <span class="number">69040319834829375335287614995435269276</span>, <span class="number">169933229202934375632745753379104389929</span>, <span class="number">72693008284867494808267387710985847974</span>, <span class="number">158548279589965576940349068403862889270</span>, <span class="number">49458101234256610254825879149914255140</span>, <span class="number">24389558269688411084589654047215902968</span>, <span class="number">210567980379246548727819953025607019254</span>, <span class="number">110423375132252997825868399832298953831</span>, <span class="number">109589895677661968369424757992411668628</span>, <span class="number">66177577069199763925999718357846633613</span>, <span class="number">83602293803708828242273186265396676466</span>, <span class="number">172226271050176278536911356541786290551</span>, <span class="number">85799805809703976643034084477579915867</span>, <span class="number">179399990302447560847151603157937241688</span>, <span class="number">81687654752229170984692833277072534294</span>, <span class="number">160766441640281044008645821822296569868</span>, <span class="number">100306680611749750243920501921769642984</span>, <span class="number">42195187332833922597871030332905266026</span>, <span class="number">238918420772178508359295233180536910768</span>, <span class="number">221685929158944699801776621298532178665</span>, <span class="number">209349638787804999657456057184702655805</span>, <span class="number">183953393268431043006359511952782903516</span>, <span class="number">137364333131365794683132159746962959967</span>, <span class="number">15637689373906596015395350692459218048</span>, <span class="number">145956368418289159411911667337899986262</span>, <span class="number">197987711355277581048877821432652325207</span>, <span class="number">125421308989313724733467092345532539875</span>, <span class="number">90525081516582408488547894471421476595</span>, <span class="number">107405840115256692042814887586009104950</span>, <span class="number">71587500700172519801649824611045199280</span>, <span class="number">10155721246869986043302768283257682883</span>, <span class="number">100522792569358427133597834727509523742</span>, <span class="number">244473925018526409824670892423775482110</span>, <span class="number">50746138425761666610345252577572889037</span>, <span class="number">142188269919422432629363225167297071042</span>, <span class="number">8235113926890598897465093754260801947</span>, <span class="number">174540885017405784646782293055852044631</span>, <span class="number">171949847901434672429841435895697323702</span>, <span class="number">34391199559497599434575002007581170988</span>, <span class="number">7337868660819385932166025474594964373</span>, <span class="number">89608475952042154068811282935241824949</span>, <span class="number">162561097613906905390170334328135062933</span>, <span class="number">252566077272083954707900007055640560669</span>, <span class="number">4284637988579219107997224848114896904</span>, <span class="number">220026371387782427901244689037957398829</span>, <span class="number">86019060485320999498155965142619258089</span>, <span class="number">19304861731281576405798605142335886482</span>, <span class="number">123188238667151068575810494833929221938</span>, <span class="number">125089740978532716086813732154638565196</span>, <span class="number">252061524500088702951562270741214799294</span>, <span class="number">89528875472312768404823823905699760649</span>, <span class="number">63307407053590054220492282094909190524</span>, <span class="number">24389558269688411084589654047215902968</span>, <span class="number">43835777110183833958990705735152973942</span>, <span class="number">196543204310466258426232803779025620993</span>, <span class="number">225032412767857179129234169288824097261</span>, <span class="number">50292890880286260984317361296226049436</span>, <span class="number">64928956886509273090981701066528078331</span>, <span class="number">25408225921774957745573142542576755590</span>, <span class="number">235921667882292842303120860570747218086</span>, <span class="number">217132603855089441017750752624514343437</span>, <span class="number">11106129204256119599329380588789107048</span>, <span class="number">147501327490657927610543345089238991876</span>, <span class="number">158091159632919983870444592039392730373</span>, <span class="number">254215886971254771885657857148535673338</span>, <span class="number">129869106474614345624950211566868568809</span>, <span class="number">10425702332274469498479699675668087022</span>, <span class="number">136595953187315682777976356839442311764</span>, <span class="number">1607792140397737044118662059498732982</span>, <span class="number">23710000155612873207506044342091514799</span>, <span class="number">118571340370877720354330132780832828911</span>, <span class="number">194624784476702188629452374731837038856</span>, <span class="number">51332273108989067644245919615090753756</span>, <span class="number">240921043405288511960365826273938845156</span>, <span class="number">158670188709175825212687487436006138030</span>, <span class="number">133641825913283256858340618209700716053</span>, <span class="number">43054466484232130048301271684438593412</span>, <span class="number">20361972967806283315536154125012604660</span>, <span class="number">135700832615866572032111395529532615300</span>, <span class="number">160609169788639387827865051539103507016</span>, <span class="number">100576279475451993660766480883708996211</span>, <span class="number">215424685541583305069271024253690375127</span>, <span class="number">60018956375784961551937423504137141702</span>, <span class="number">107997941230633604720421526632224279451</span>, <span class="number">219482010609171816035007605036664317041</span>, <span class="number">22173526221024380740269311947729076493</span>, <span class="number">249746554302052221287371350978970766087</span>, <span class="number">93207359085331319264650563354951254906</span>, <span class="number">221421697282310997113867048083058096452</span>, <span class="number">61834092635779365101011109381392037516</span>, <span class="number">162215218701897689647766394615098617152</span>, <span class="number">141856131587452385513407955541400099703</span>, <span class="number">177910903795887762773545874929605680469</span>, <span class="number">228832704523723308335513552177377803295</span>, <span class="number">229427981969125094398744034150988525118</span>, <span class="number">217938760689082034514008764751385239765</span>, <span class="number">3238055163645731541423094980789895030</span>, <span class="number">42308449860804765793467328093112118974</span>, <span class="number">254764518926620089428032312378507653680</span>, <span class="number">215733901156118606036318409454786603209</span>, <span class="number">59640829345183339336712595595022506261</span>, <span class="number">33515071724475649656070325837411550208</span>, <span class="number">51175659069843551646353202764296812462</span>, <span class="number">211462959696081863041546889096760952490</span>, <span class="number">230559603938699838189391087728971115767</span>, <span class="number">85878911733601049548471257838175175563</span>, <span class="number">214134904074265214033878852207103328297</span>, <span class="number">160702405980652445507529591230654474171</span>, <span class="number">223755040649990285320102091954198427148</span>, <span class="number">166476753890268002826149533120107157745</span>, <span class="number">26283916639129998224675164834425763384</span>, <span class="number">232971495542024495583092055361321729894</span>, <span class="number">79741799146769724681649849525636816379</span>, <span class="number">228506526471280046809909301748098760369</span>, <span class="number">167502422063741368765891061653686283332</span>, <span class="number">26984184590668253713951516794937308166</span>, <span class="number">105952393031190074432183821281493254</span>, <span class="number">113823192955281698937767041115166174652</span>, <span class="number">93264047694114869263275726820602569731</span>, <span class="number">55481974783112950660682138071588408040</span>, <span class="number">108961894273530837550182447112767144669</span>, <span class="number">47975793549419083945738147934068241928</span>, <span class="number">204024371586357035343484206754422857590</span>, <span class="number">251859351272989525849999231358507018068</span>, <span class="number">75939709807860493804628805619699991501</span>, <span class="number">129031774446142139804436921156668129187</span>, <span class="number">110764318451937254261883856778359218969</span>, <span class="number">246404864722813298477426808193494673610</span>, <span class="number">153818236564405157581869620439634140065</span>, <span class="number">246125932167584353084676586883038397451</span>]  <span class="comment"># 实际密文是一个包含多个整数的列表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    binary_str = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> ciphertext:</span><br><span class="line">        bit = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 尝试b=0的情况：base = a + 0*d = a（d不影响）</span></span><br><span class="line">        base = a</span><br><span class="line">        <span class="keyword">for</span> e <span class="keyword">in</span> possible_e:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">pow</span>(base, e, p) == n:</span><br><span class="line">                bit = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果不是b=0，尝试b=1的情况（d=1到10）</span></span><br><span class="line">        <span class="keyword">if</span> bit <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">                base = a + d  <span class="comment"># base = a + 1*d</span></span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> possible_e:</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">pow</span>(base, e, p) == n:</span><br><span class="line">                        bit = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">if</span> bit <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> bit <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;无法解析密文: <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">        binary_str += bit</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将二进制字符串转换为字节</span></span><br><span class="line">    flag_bytes = <span class="built_in">bytes</span>([<span class="built_in">int</span>(binary_str[i:i + <span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>)])</span><br><span class="line">    <span class="keyword">return</span> flag_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = decrypt(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密得到flag:&quot;</span>, flag.decode())</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密失败:&quot;</span>, <span class="built_in">str</span>(e))</span><br></pre></td></tr></table></figure>

<h3 id="baby-next"><a href="#baby-next" class="headerlink" title="baby_next"></a>baby_next</h3><p><strong>题目</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">38</span></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">7</span>] == <span class="string">b&#x27;moectf&#123;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> flag[-<span class="number">1</span>:] == <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = <span class="built_in">int</span>(reduce(<span class="keyword">lambda</span> res, _: next_prime(res), <span class="built_in">range</span>(<span class="number">114514</span>), p))</span><br><span class="line"></span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line">    pri</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line">n = <span class="number">96742777571959902478849172116992100058097986518388851527052638944778038830381328778848540098201307724752598903628039482354215330671373992156290837979842156381411957754907190292238010742130674404082688791216045656050228686469536688900043735264177699512562466087275808541376525564145453954694429605944189276397</span></span><br><span class="line">c = <span class="number">17445962474813629559693587749061112782648120738023354591681532173123918523200368390246892643206880043853188835375836941118739796280111891950421612990713883817902247767311707918305107969264361136058458670735307702064189010952773013588328843994478490621886896074511809007736368751211179727573924125553940385967</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">96742777571959902478849172116992100058097986518388851527052638944778038830381328778848540098201307724752598903628039482354215330671373992156290837979842156381411957754907190292238010742130674404082688791216045656050228686469536688900043735264177699512562466087275808541376525564145453954694429605944189276397</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p= <span class="number">9835790642950870702456388102541833011851580184211232019829465812360043670916676289614924432072209183922656300400121695605187082642402117584019839337925591</span></span><br><span class="line">q = <span class="number">9835790642950870702456388102541833011851580184211232019829465812360043670916676289614924432072209183922656300400121695605187082642402117584019839297179867</span></span><br><span class="line">c = <span class="number">17445962474813629559693587749061112782648120738023354591681532173123918523200368390246892643206880043853188835375836941118739796280111891950421612990713883817902247767311707918305107969264361136058458670735307702064189010952773013588328843994478490621886896074511809007736368751211179727573924125553940385967</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="ezBSGS"><a href="#ezBSGS" class="headerlink" title="ezBSGS"></a>ezBSGS</h3><p>题目：西小电注意到，第一周的题目中出现了若干神秘数字，并且他还发现这些神秘数字与神秘Flag有关，具体地，x<em>x</em> 是能够满足神秘式子 13x&#x3D;114514mod  10000000000009913<em>x</em>&#x3D;114514mod100000000000099 的最小整数，flag内容即为 x<em>x</em> ，你能帮助西小电求出正确的 Flag 吗？</p>
<p><em>“好奇怪的标题啊，BSGS是什么？北上广深吗？”</em></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">baby_step_giant_step</span>(<span class="params">a, b, p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Solves a^x ≡ b (mod p) for x using the Baby-step Giant-step algorithm.</span></span><br><span class="line"><span class="string">    Returns the smallest positive integer x if found, otherwise -1.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a = a % p</span><br><span class="line">    b = b % p</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Handle trivial cases</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    m = <span class="built_in">int</span>(math.isqrt(p)) + <span class="number">1</span>  <span class="comment"># Ceiling of sqrt(p)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Baby-step: store a^j mod p in a dictionary</span></span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    curr = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        table[curr] = j</span><br><span class="line">        curr = (curr * a) % p</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Precompute a^&#123;-m&#125; mod p</span></span><br><span class="line">    a_m = <span class="built_in">pow</span>(a, m, p)</span><br><span class="line">    a_m_inv = invert(a_m, p)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Giant-step: search for b * (a^&#123;-m&#125;)^i mod p in the table</span></span><br><span class="line">    curr = b</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> curr <span class="keyword">in</span> table:</span><br><span class="line">            x = i * m + table[curr]</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        curr = (curr * a_m_inv) % p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>  <span class="comment"># No solution found</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Given values</span></span><br><span class="line">a = <span class="number">13</span></span><br><span class="line">b = <span class="number">114514</span></span><br><span class="line">p = <span class="number">100000000000099</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solve for x</span></span><br><span class="line">x = baby_step_giant_step(a, b, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x != -<span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Found x = <span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Flag is: <span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution found&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="happyRSA"><a href="#happyRSA" class="headerlink" title="happyRSA"></a>happyRSA</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">power_tower_mod</span>(<span class="params">a, k, m</span>):  <span class="comment"># a↑↑k mod m</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a % m</span><br><span class="line">    exp = power_tower_mod(a, k - <span class="number">1</span>, totient(m))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a, <span class="built_in">int</span>(exp), <span class="built_in">int</span>(m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = <span class="number">123456</span></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n_phi= p+q-<span class="number">1</span></span><br><span class="line">x=power_tower_mod(n_phi + <span class="number">1</span>, r, <span class="built_in">pow</span>(n_phi, <span class="number">3</span>))</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x = <span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 128523866891628647198256249821889078729612915602126813095353326058434117743331117354307769466834709121615383318360553158180793808091715290853250784591576293353438657705902690576369228616974691526529115840225288717188674903706286837772359866451871219784305209267680502055721789166823585304852101129034033822731</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 125986017030189249606833383146319528808010980928552142070952791820726011301355101112751401734059277025967527782109331573869703458333443026446504541008332002497683482554529670817491746530944661661838872530737844860894779846008432862757182462997411607513582892540745324152395112372620247143278397038318619295886</span></span><br><span class="line"><span class="string">x = 522964948416919148730075013940176144502085141572251634384238148239059418865743755566045480035498265634350869368780682933647857349700575757065055513839460630399915983325017019073643523849095374946914449481491243177810902947558024707988938268598599450358141276922628627391081922608389234345668009502520912713141</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">128523866891628647198256249821889078729612915602126813095353326058434117743331117354307769466834709121615383318360553158180793808091715290853250784591576293353438657705902690576369228616974691526529115840225288717188674903706286837772359866451871219784305209267680502055721789166823585304852101129034033822731</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">125986017030189249606833383146319528808010980928552142070952791820726011301355101112751401734059277025967527782109331573869703458333443026446504541008332002497683482554529670817491746530944661661838872530737844860894779846008432862757182462997411607513582892540745324152395112372620247143278397038318619295886</span></span><br><span class="line">x = <span class="number">522964948416919148730075013940176144502085141572251634384238148239059418865743755566045480035498265634350869368780682933647857349700575757065055513839460630399915983325017019073643523849095374946914449481491243177810902947558024707988938268598599450358141276922628627391081922608389234345668009502520912713141</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：计算t = p + q - 1</span></span><br><span class="line"><span class="comment"># 由x = t² + t + 1 =&gt; 4x - 3 = (2t + 1)²，求解t</span></span><br><span class="line">four_x_minus_3 = <span class="number">4</span> * x - <span class="number">3</span></span><br><span class="line">sqrt_four_x = math.isqrt(four_x_minus_3)</span><br><span class="line"><span class="comment"># 验证是否为完全平方数</span></span><br><span class="line"><span class="keyword">assert</span> sqrt_four_x * sqrt_four_x == four_x_minus_3, <span class="string">&quot;4x-3不是完全平方数&quot;</span></span><br><span class="line"></span><br><span class="line">t = (sqrt_four_x - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line"><span class="comment"># 验证t是否正确</span></span><br><span class="line"><span class="keyword">assert</span> t * t + t + <span class="number">1</span> == x, <span class="string">&quot;t计算错误&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：计算s = p + q</span></span><br><span class="line">s = t + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：计算p和q（由p + q = s和p * q = n）</span></span><br><span class="line"><span class="comment"># 解方程x² - s x + n = 0，判别式D = s² - 4n</span></span><br><span class="line">D = s * s - <span class="number">4</span> * n</span><br><span class="line">sqrt_D = math.isqrt(D)</span><br><span class="line"><span class="keyword">assert</span> sqrt_D * sqrt_D == D, <span class="string">&quot;D不是完全平方数&quot;</span></span><br><span class="line"></span><br><span class="line">p = (s + sqrt_D) // <span class="number">2</span></span><br><span class="line">q = (s - sqrt_D) // <span class="number">2</span></span><br><span class="line"><span class="comment"># 验证p*q是否等于n</span></span><br><span class="line"><span class="keyword">assert</span> p * q == n, <span class="string">&quot;p和q计算错误&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤4：RSA解密</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)  <span class="comment"># 求e的逆元</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)     <span class="comment"># 解密得到flag的长整数形式</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节并输出</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>模密塔计算原理</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250816125657470.png" alt="image-20250816125657470"></p>
<h3 id="ez-aes"><a href="#ez-aes" class="headerlink" title="ez_aes"></a>ez_aes</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">rc = [<span class="number">0x12</span>, <span class="number">0x23</span>, <span class="number">0x34</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x67</span>, <span class="number">0x78</span>, <span class="number">0x89</span>, <span class="number">0x9a</span>, <span class="number">0xab</span>, <span class="number">0xbc</span>, <span class="number">0xcd</span>, <span class="number">0xde</span>, <span class="number">0xef</span>,<span class="number">0xf1</span>]</span><br><span class="line"></span><br><span class="line">s_box = [</span><br><span class="line">	[<span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>],</span><br><span class="line">	[<span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>],</span><br><span class="line">	[<span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>],</span><br><span class="line">	[<span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>],</span><br><span class="line">	[<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>],</span><br><span class="line">	[<span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>],</span><br><span class="line">	[<span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>],</span><br><span class="line">	[<span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>],</span><br><span class="line">	[<span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>],</span><br><span class="line">	[<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>],</span><br><span class="line">	[<span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>],</span><br><span class="line">	[<span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>],</span><br><span class="line">	[<span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>],</span><br><span class="line">	[<span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>],</span><br><span class="line">	[<span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>],</span><br><span class="line">	[<span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">s_box_inv = [</span><br><span class="line">	[<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>],</span><br><span class="line">	[<span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>],</span><br><span class="line">	[<span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>],</span><br><span class="line">	[<span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>],</span><br><span class="line">	[<span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>],</span><br><span class="line">	[<span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>],</span><br><span class="line">	[<span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>],</span><br><span class="line">	[<span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>],</span><br><span class="line">	[<span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>],</span><br><span class="line">	[<span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>],</span><br><span class="line">	[<span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>],</span><br><span class="line">	[<span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>],</span><br><span class="line">	[<span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>],</span><br><span class="line">	[<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>],</span><br><span class="line">	[<span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>],</span><br><span class="line">	[<span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(grid):</span><br><span class="line">        grid[i] = s_box[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0xf</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        grid[i::<span class="number">4</span>] = grid[i::<span class="number">4</span>][i:] + grid[i::<span class="number">4</span>][:i]</span><br><span class="line">        grid =grid[<span class="number">0</span>::<span class="number">4</span>]+grid[<span class="number">1</span>::<span class="number">4</span>]+grid[<span class="number">2</span>::<span class="number">4</span>]+grid[<span class="number">3</span>::<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul_by_2</span>(<span class="params">n</span>):</span><br><span class="line">        s = (n &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">128</span>:</span><br><span class="line">            s ^= <span class="number">0x1b</span></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mul_by_3</span>(<span class="params">n</span>):</span><br><span class="line">        <span class="keyword">return</span> n ^ mul_by_2(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mix_column</span>(<span class="params">c</span>):</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            mul_by_2(c[<span class="number">0</span>]) ^ mul_by_3(c[<span class="number">1</span>]) ^ c[<span class="number">2</span>] ^ c[<span class="number">3</span>],  <span class="comment"># [2 3 1 1]</span></span><br><span class="line">	    c[<span class="number">0</span>] ^ mul_by_2(c[<span class="number">1</span>]) ^ mul_by_3(c[<span class="number">2</span>]) ^ c[<span class="number">3</span>],  <span class="comment"># [1 2 3 1]</span></span><br><span class="line">	    c[<span class="number">0</span>] ^ c[<span class="number">1</span>] ^ mul_by_2(c[<span class="number">2</span>]) ^ mul_by_3(c[<span class="number">3</span>]),  <span class="comment"># [1 1 2 3]</span></span><br><span class="line">	    mul_by_3(c[<span class="number">0</span>]) ^ c[<span class="number">1</span>] ^ c[<span class="number">2</span>] ^ mul_by_2(c[<span class="number">3</span>]),  <span class="comment"># [3 1 1 2]</span></span><br><span class="line">	]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>):</span><br><span class="line">        grid[i:i + <span class="number">4</span>] = mix_column(grid[i:i + <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_expansion</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span> * <span class="number">4</span>):</span><br><span class="line">        r = grid[-<span class="number">4</span>:]</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:  <span class="comment"># 对上一轮最后4字节自循环、S-box置换、轮常数异或，从而计算出当前新一轮最前4字节</span></span><br><span class="line">            <span class="keyword">for</span> j, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(r[<span class="number">1</span>:] + r[:<span class="number">1</span>]):</span><br><span class="line">                r[j] = s_box[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0xf</span>] ^ (rc[i // <span class="number">4</span>] <span class="keyword">if</span> j == <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            grid.append(grid[-<span class="number">16</span>] ^ r[j])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> grid</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">grid, round_key</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        grid[i] ^= round_key[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">b, expanded_key</span>):</span><br><span class="line">    <span class="comment"># First round</span></span><br><span class="line">    add_round_key(b, expanded_key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        sub_bytes(b)</span><br><span class="line">        shift_rows(b)</span><br><span class="line">        mix_columns(b)</span><br><span class="line">        add_round_key(b, expanded_key[i * <span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Final round</span></span><br><span class="line">    sub_bytes(b)</span><br><span class="line">    shift_rows(b)</span><br><span class="line">    add_round_key(b, expanded_key[-<span class="number">16</span>:])</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes</span>(<span class="params">key, msg</span>):</span><br><span class="line">    expanded = key_expansion(<span class="built_in">bytearray</span>(key))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Pad the message to a multiple of 16 bytes</span></span><br><span class="line">    b = <span class="built_in">bytearray</span>(msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">16</span> - <span class="built_in">len</span>(msg) % <span class="number">16</span>))</span><br><span class="line">    <span class="comment"># Encrypt the message</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(b), <span class="number">16</span>):</span><br><span class="line">        b[i:i + <span class="number">16</span>] = encrypt(b[i:i + <span class="number">16</span>], expanded)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    key = <span class="string">b&#x27;Slightly different from the AES.&#x27;</span></span><br><span class="line">    enc = aes(key, flag)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Encrypted:&#x27;</span>, enc)</span><br><span class="line">    <span class="comment">#Encrypted: b&#x27;%\x98\x10\x8b\x93O\xc7\xf02F\xae\xedA\x96\x1b\xf9\x9d\x96\xcb\x8bT\r\xd31P\xe6\x1a\xa1j\x0c\xe6\xc8&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 还原与你提供的脚本一致的常量与表</span></span><br><span class="line">rc = [<span class="number">0x12</span>, <span class="number">0x23</span>, <span class="number">0x34</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x67</span>, <span class="number">0x78</span>, <span class="number">0x89</span>, <span class="number">0x9a</span>, <span class="number">0xab</span>, <span class="number">0xbc</span>, <span class="number">0xcd</span>, <span class="number">0xde</span>, <span class="number">0xef</span>, <span class="number">0xf1</span>]</span><br><span class="line"></span><br><span class="line">s_box = [</span><br><span class="line">    [<span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>],</span><br><span class="line">    [<span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>],</span><br><span class="line">    [<span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>],</span><br><span class="line">    [<span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>],</span><br><span class="line">    [<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>],</span><br><span class="line">    [<span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>],</span><br><span class="line">    [<span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>],</span><br><span class="line">    [<span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>],</span><br><span class="line">    [<span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>],</span><br><span class="line">    [<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>],</span><br><span class="line">    [<span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>],</span><br><span class="line">    [<span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>],</span><br><span class="line">    [<span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>],</span><br><span class="line">    [<span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>],</span><br><span class="line">    [<span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>],</span><br><span class="line">    [<span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：这一张表里有个位置很容易手抖输错（第二行第8个是 0x87）</span></span><br><span class="line">s_box_inv = [</span><br><span class="line">    [<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>],</span><br><span class="line">    [<span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>],</span><br><span class="line">    [<span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>],</span><br><span class="line">    [<span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>],</span><br><span class="line">    [<span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>],</span><br><span class="line">    [<span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>],</span><br><span class="line">    [<span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>],</span><br><span class="line">    [<span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>],</span><br><span class="line">    [<span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>],</span><br><span class="line">    [<span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>],</span><br><span class="line">    [<span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>],</span><br><span class="line">    [<span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>],</span><br><span class="line">    [<span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>],</span><br><span class="line">    [<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>],</span><br><span class="line">    [<span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>],</span><br><span class="line">    [<span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">state: <span class="built_in">bytearray</span>, round_key: <span class="built_in">bytes</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;逐字节 XOR 轮密钥&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        state[i] ^= round_key[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">state: <span class="built_in">bytearray</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;S 盒代换&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(state):</span><br><span class="line">        state[i] = s_box[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0x0F</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">state: <span class="built_in">bytearray</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;逆 S 盒代换&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(state):</span><br><span class="line">        state[i] = s_box_inv[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0x0F</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_expansion</span>(<span class="params">key_bytes: <span class="built_in">bytearray</span></span>) -&gt; <span class="built_in">bytearray</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    题目给的“密钥扩展”原样实现。</span></span><br><span class="line"><span class="string">    注意：它允许以 32 字节 key 起步，然后继续按 16 字节步长扩展，共得到 192 字节（12 组）轮密钥。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span> * <span class="number">4</span>):</span><br><span class="line">        r = key_bytes[-<span class="number">4</span>:]</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 轮变换：RotWord -&gt; SubWord -&gt; XOR Rcon（这里的 rc 与标准 AES Rcon 不同）</span></span><br><span class="line">            <span class="keyword">for</span> j, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(r[<span class="number">1</span>:] + r[:<span class="number">1</span>]):</span><br><span class="line">                r[j] = s_box[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0x0F</span>] ^ (rc[i // <span class="number">4</span>] <span class="keyword">if</span> j == <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            key_bytes.append(key_bytes[-<span class="number">16</span>] ^ r[j])</span><br><span class="line">    <span class="keyword">return</span> key_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gmul</span>(<span class="params">a: <span class="built_in">int</span>, b: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;GF(2^8) 下的乘法（不可约多项式 x^8 + x^4 + x^3 + x + 1）&quot;&quot;&quot;</span></span><br><span class="line">    p = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> b &amp; <span class="number">1</span>:</span><br><span class="line">            p ^= a</span><br><span class="line">        hi = a &amp; <span class="number">0x80</span></span><br><span class="line">        a = (a &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">if</span> hi:</span><br><span class="line">            a ^= <span class="number">0x1B</span></span><br><span class="line">        b &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> p &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">state: <span class="built_in">bytearray</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;列混淆（实际上按连续 4 字节一组进行变换）&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>):</span><br><span class="line">        c0, c1, c2, c3 = state[i:i+<span class="number">4</span>]</span><br><span class="line">        state[i+<span class="number">0</span>] = gmul(c0,<span class="number">2</span>) ^ gmul(c1,<span class="number">3</span>) ^ c2 ^ c3</span><br><span class="line">        state[i+<span class="number">1</span>] = c0 ^ gmul(c1,<span class="number">2</span>) ^ gmul(c2,<span class="number">3</span>) ^ c3</span><br><span class="line">        state[i+<span class="number">2</span>] = c0 ^ c1 ^ gmul(c2,<span class="number">2</span>) ^ gmul(c3,<span class="number">3</span>)</span><br><span class="line">        state[i+<span class="number">3</span>] = gmul(c0,<span class="number">3</span>) ^ c1 ^ c2 ^ gmul(c3,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">state: <span class="built_in">bytearray</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;逆列混淆（乘以 14/11/13/9 的标准逆矩阵）&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>):</span><br><span class="line">        c0, c1, c2, c3 = state[i:i+<span class="number">4</span>]</span><br><span class="line">        state[i+<span class="number">0</span>] = gmul(c0,<span class="number">14</span>) ^ gmul(c1,<span class="number">11</span>) ^ gmul(c2,<span class="number">13</span>) ^ gmul(c3,<span class="number">9</span>)</span><br><span class="line">        state[i+<span class="number">1</span>] = gmul(c0,<span class="number">9</span>)  ^ gmul(c1,<span class="number">14</span>) ^ gmul(c2,<span class="number">11</span>) ^ gmul(c3,<span class="number">13</span>)</span><br><span class="line">        state[i+<span class="number">2</span>] = gmul(c0,<span class="number">13</span>) ^ gmul(c1,<span class="number">9</span>)  ^ gmul(c2,<span class="number">14</span>) ^ gmul(c3,<span class="number">11</span>)</span><br><span class="line">        state[i+<span class="number">3</span>] = gmul(c0,<span class="number">11</span>) ^ gmul(c1,<span class="number">13</span>) ^ gmul(c2,<span class="number">9</span>)  ^ gmul(c3,<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">block: <span class="built_in">bytes</span>, expanded_key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    逐块解密（完全按加密的反序执行）：</span></span><br><span class="line"><span class="string">    最后一轮：AddRoundKey(K_last) -&gt; InvSubBytes（无行移位）</span></span><br><span class="line"><span class="string">    中间 9 轮（r=9..1）：AddRoundKey(K_r) -&gt; InvMixColumns -&gt; InvSubBytes</span></span><br><span class="line"><span class="string">    开头：AddRoundKey(K_0)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    st = <span class="built_in">bytearray</span>(block)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反最后一轮：先异或最后一轮轮密钥，再逆 S 盒（原题 shift_rows 等价空操作）</span></span><br><span class="line">    add_round_key(st, expanded_key[-<span class="number">16</span>:])</span><br><span class="line">    inv_sub_bytes(st)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反向执行中间 9 轮</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        add_round_key(st, expanded_key[r*<span class="number">16</span>:])  <span class="comment"># 题目里 add_round_key 只取前 16 字节</span></span><br><span class="line">        inv_mix_columns(st)</span><br><span class="line">        inv_sub_bytes(st)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反最初一轮的 AddRoundKey</span></span><br><span class="line">    add_round_key(st, expanded_key[:<span class="number">16</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(st)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ECB 模式逐块解密（题目即如此），返回原始（含 0 填充）的明文&quot;&quot;&quot;</span></span><br><span class="line">    sched = key_expansion(<span class="built_in">bytearray</span>(key))</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">16</span>):</span><br><span class="line">        out.extend(decrypt_block(ciphertext[i:i+<span class="number">16</span>], sched))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 题目给定的 key 与密文</span></span><br><span class="line">    key = <span class="string">b&quot;Slightly different from the AES.&quot;</span></span><br><span class="line">    cipher = <span class="string">b&quot;%\x98\x10\x8b\x93O\xc7\xf02F\xae\xedA\x96\x1b\xf9\x9d\x96\xcb\x8bT\r\xd31P\xe6\x1a\xa1j\x0c\xe6\xc8&quot;</span></span><br><span class="line"></span><br><span class="line">    plain = decrypt(cipher, key)</span><br><span class="line">    <span class="comment"># 题目加密时用了 0 填充，这里演示同时打印“原样字节串”和“去 0 填充后”的文本</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Plain (raw bytes):&quot;</span>, plain)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Plain (stripped):&quot;</span>, plain.rstrip(<span class="string">b&quot;\x00&quot;</span>).decode(<span class="string">&quot;latin1&quot;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>原理</strong></p>
<p>你会看到它<strong>看起来像 AES</strong>，但很多细节与标准 AES 不同，甚至有个小 bug 让 <code>ShiftRows</code> 实际上变成了<strong>空操作</strong>，这也是解密脚本里为什么不需要“逆移位”的原因。</p>
<p><strong>整体流程</strong>（逐块 ECB）</p>
<p>分组：明文按 <strong>16 字节</strong>一块处理（ECB 模式），不足 16 字节用<strong>零填充</strong>。</p>
<p>轮数：总共 <strong>10 轮</strong>（和 AES-128 一样是“初始异或 + 9 个中间轮 + 最后一轮”）。</p>
<p>每轮操作次序（按题目实现）：</p>
<p>  初始：<code>AddRoundKey(K0)</code></p>
<p>  第 1～9 轮：<code>SubBytes</code> → <code>ShiftRows</code>（但此实现为<strong>空操作</strong>）→ <code>MixColumns</code> → <code>AddRoundKey(Kr)</code></p>
<p>  最后一轮：<code>SubBytes</code> → <code>ShiftRows</code>（同样是空操作）→ <code>AddRoundKey(K_last)</code>（<strong>无</strong> MixColumns）</p>
<p>  这意味着<strong>解密</strong>时要把每一步<strong>逆过来并倒序</strong>执行（见后文）。</p>
<p><strong>状态与四个基本变换</strong></p>
<ol>
<li>AddRoundKey</li>
</ol>
<ul>
<li>就是把 16 字节状态与 16 字节轮密钥逐字节 XOR。</li>
<li>题目代码里 <code>add_round_key(grid, round_key)</code> 的 <code>round_key</code> 只取<strong>传入切片的前 16 字节</strong>。</li>
</ul>
<ol start="2">
<li>SubBytes（字节代换）</li>
</ol>
<ul>
<li><p>用的是标准 AES S-box（你看到的 <code>s_box</code> 表），对每个字节独立查表替换。</p>
</li>
<li><p>逆操作 <code>InvSubBytes</code> 用 <code>s_box_inv</code>。</p>
<p>3.ShiftRows（行移位）——<strong>这里出 bug，等价空操作</strong></p>
</li>
</ul>
<p>题目中的实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    grid[i::<span class="number">4</span>] = grid[i::<span class="number">4</span>][i:] + grid[i::<span class="number">4</span>][:i]</span><br><span class="line">    grid = grid[<span class="number">0</span>::<span class="number">4</span>] + grid[<span class="number">1</span>::<span class="number">4</span>] + grid[<span class="number">2</span>::<span class="number">4</span>] + grid[<span class="number">3</span>::<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>关键问题在第二行：<code>grid = ...</code> 把<strong>局部变量</strong> <code>grid</code> 重新绑定到一个新列表，后续循环的修改都发生在这个<strong>新列表</strong>上，而不是调用者传入的原始列表。<br> 真正“写回到原列表”的只有第一行那次<strong>切片赋值</strong>；但当 <code>i == 0</code> 时旋转 0 位，本来就什么都不变。后续 <code>i==1,2,3</code> 的行移位并<strong>没有</strong>作用到原列表。因此整个函数<strong>净效果为 0</strong>。</p>
<blockquote>
<p>结论：这份代码里的 <code>ShiftRows</code> 实际上没做任何行移位；轮与轮之间不会像真 AES 那样“交叉搅拌”不同列的数据。</p>
</blockquote>
<ol start="4">
<li>MixColumns（列混淆）</li>
</ol>
<ul>
<li><p>仍然是 GF(2⁸) 上的线性变换，但它是按<strong>连续 4 字节一组</strong>做的：</p>
<ul>
<li><p>对每个块的字节 <code>b[i:i+4]</code> 应用矩阵</p>
<p>[2311123111233112]\begin{bmatrix} 2&amp;3&amp;1&amp;1\ 1&amp;2&amp;3&amp;1\ 1&amp;1&amp;2&amp;3\ 3&amp;1&amp;1&amp;2 \end{bmatrix}</p>
</li>
<li><p>乘法用 AES 同款不可约多项式 $x^8+x^4+x^3+x+1$（代码里 <code>^ 0x1B</code>）。</p>
</li>
</ul>
</li>
<li><p>因为 <code>ShiftRows</code> 没有效果，<strong>每个 16 字节块一直被当成 4 个互不“串门”的小组</strong>：[0..3]、[4..7]、[8..11]、[12..15]，在所有轮次里都只在各自小组内混合，不会跨组扩散。这使得整体扩散性明显弱于真 AES。</p>
</li>
<li><p>逆操作 <code>InvMixColumns</code> 用到经典的逆矩阵（乘以 14、11、13、9），这就是解密脚本里那段 <code>gmul(..., 14/11/13/9)</code> 的来源。</p>
</li>
</ul>
<p><strong>密钥扩展</strong>（与 AES 大不相同）</p>
<ul>
<li>初始密钥是 <strong>32 字节</strong>（而不是 AES-128 的 16 字节）。代码从这 32 字节出发进行“扩展”：<ol>
<li>做 <strong>40 次</strong>迭代（<code>for i in range(10*4)</code>）。</li>
<li>每次取“当前末尾 4 字节”做处理：当 <code>i % 4 == 0</code> 时，对这 4 字节先 <strong>循环左移 1 字节</strong>，再逐字节走 S-box，最后<strong>只</strong>在第一个字节 XOR 一个非标的“轮常数” <code>rc[i//4]</code>（注意这 <code>rc</code> 也不是 AES 的 Rcon，且只异或到一个字节上）。</li>
<li>然后<strong>生成 4 个新字节</strong>：<code>new_byte = key_bytes[-16] ^ r[j]</code> —— 也就是说，每个新字节都拿<strong>16 字节之前</strong>的那个字节 XOR 上变换后的 <code>r[j]</code>。<br> 这与标准 AES 的“按 4 字节词计算、与 Nk 或 Nk-1 的词做 XOR”的逻辑完全不同。</li>
</ol>
</li>
<li>最终扩展长度：初始 32 字节 + 40 轮 × 4 字节 &#x3D; <strong>192 字节</strong>，即 12 组“16 字节轮密钥”。</li>
</ul>
<p><strong>但真正用到的只有 11 组：</strong></p>
<ul>
<li><code>K0</code> &#x3D; 扩展结果的 <strong>前 16 字节</strong>（也就是初始密钥的<strong>前半</strong>）。</li>
<li><code>K1</code>～<code>K9</code> &#x3D; 偏移 16、32、…、144 的 9 组。</li>
<li><code>K_last</code> &#x3D; <strong>最后 16 字节</strong>（偏移 176）。<br> 中间偏移 <strong>160～175</strong> 的那 16 字节<strong>完全没被使用</strong>（代码小设计瑕疵）。</li>
</ul>
<p><strong>加密与解密的对称关系</strong></p>
<p>设一轮（非最后一轮）的加密为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = AddKey( Mix( Sub(state) ), Kr )</span><br></pre></td></tr></table></figure>

<p>因为 <code>ShiftRows</code> 等价空操作，所以忽略不计。<br> 则其逆操作就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state = InvSub( InvMix( AddKey(state, Kr) ) )</span><br></pre></td></tr></table></figure>

<p>因此解密顺序是：</p>
<ol>
<li><strong>反最后一轮</strong><ul>
<li><code>AddKey(K_last)</code> → <code>InvSub</code>（最后一轮加密没有 MixColumns，所以解密也不做 InvMix）</li>
</ul>
</li>
<li><strong>反第 9～1 轮</strong>（倒序）<ul>
<li>对每个 r &#x3D; 9..1：<code>AddKey(Kr)</code> → <code>InvMixColumns</code> → <code>InvSub</code></li>
</ul>
</li>
<li><strong>反初始轮</strong><ul>
<li><code>AddKey(K0)</code>（完成）</li>
</ul>
</li>
</ol>
<p>这正是解密脚本里实现的流程。</p>
<p><strong>与“真 AES”的差异小结</strong></p>
<ul>
<li>✅ S-box&#x2F;Inv S-box 与 GF(2⁸) 乘法常量是正宗 AES 的。</li>
<li>❌ <code>ShiftRows</code> 实现有 bug → 实际<strong>不生效</strong>。</li>
<li>❌ <code>MixColumns</code> 虽然本身正确，但由于没行移位，<strong>永远只在固定的 4 字节小组内作用</strong>。</li>
<li>❌ 密钥扩展完全非标：<ul>
<li>用了 32 字节初始 key，</li>
<li>Rcon 表非标且只异或到 1 字节，</li>
<li>生成新字节时与“16 字节之前”的字节 XOR，</li>
<li>扩展出 12 组轮密钥却只用 11 组，中间空出一组。</li>
</ul>
</li>
<li>✅ 轮结构层数与“最后一轮无列混淆”的形态与 AES-128 外观一致。</li>
</ul>
<p>这些差异让该算法的安全性与真正 AES 相差甚远，但对逆向&#x2F;解题来说非常友好：只要<strong>按实现反过来</strong>写就能直接解出明文（我们已经用脚本还原出 <code>moectf&#123;Th1s_1s_4n_E4ZY_AE5_!@#&#125;</code>）。</p>
<p><strong>为什么脚本里不做“逆行移位”？</strong></p>
<p>  如上所述，题目中的 <code>ShiftRows</code> 因为局部变量重绑定导致<strong>对外部状态没有效果</strong>，所以加密阶段根本没有发生行移位；解密自然也就<strong>不需要</strong>逆移位。</p>
<p><strong>2. 加密流程异常的连锁影响</strong></p>
<p>由于<code>shift_rows</code>函数实际未生效（相当于 “空操作”），整个加密流程偏离了 AES 标准：</p>
<ul>
<li>行移位操作未执行，后续的<code>mix_columns</code>（列混合）等步骤基于错误的数据排列进行，导致密文生成异常。</li>
<li>该变体虽意图实现 AES-256（密钥长度相关配置），但密钥扩展过程（<code>key_expansion</code>）存在不一致性，进一步增加了加密结果的不确定性。</li>
<li>解密时需<strong>镜像加密漏洞</strong>：由于加密时<code>shift_rows</code>未生效，解密时的 “逆行移位”（<code>inv_shift_rows</code>）也需设为 “空操作”，才能保证解密逻辑与加密逻辑一致。</li>
</ul>
<p><strong>3. 解密思路：逆向加密步骤</strong></p>
<p>要解密密文，需严格逆向加密流程（含漏洞），步骤如下：</p>
<ol>
<li><strong>从最后一轮开始</strong>：先执行 “逆轮密钥加”（用最后一轮的轮密钥），再执行 “逆字节代换”（<code>inv_sub_bytes</code>）。</li>
<li><strong>逆向中间 9 轮</strong>：按 “轮密钥加 → 逆列混合（<code>inv_mix_columns</code>） → 逆字节代换” 的顺序执行（因<code>shift_rows</code>空操作，逆操作也省略）。</li>
<li><strong>初始轮密钥加</strong>：最后执行初始轮的 “轮密钥加”，恢复明文。</li>
</ol>
<p><strong>4. 关键数据结构定义</strong></p>
<p>S 盒（字节代换表）</p>
<p>AES 标准的 S 盒，用于<code>sub_bytes</code>（字节代换）操作，将输入字节映射为新字节。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">s_box = [</span><br><span class="line">    [<span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>],</span><br><span class="line">    [<span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>],</span><br><span class="line">    [<span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>],</span><br><span class="line">    [<span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>],</span><br><span class="line">    [<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>],</span><br><span class="line">    [<span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>],</span><br><span class="line">    [<span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>],</span><br><span class="line">    [<span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>],</span><br><span class="line">    [<span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>],</span><br><span class="line">    [<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>],</span><br><span class="line">    [<span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>],</span><br><span class="line">    [<span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>],</span><br><span class="line">    [<span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>],</span><br><span class="line">    [<span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>],</span><br><span class="line">    [<span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>],</span><br><span class="line">    [<span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>4.2 逆 S 盒（逆字节代换表）</p>
<p>用于<code>inv_sub_bytes</code>（逆字节代换）操作，修复了原始代码中<code>0xff</code>后误写为<code>0</code>的错误（正确值为<code>0x87</code>）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">s_box_inv = [</span><br><span class="line">    [<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>],</span><br><span class="line">    [<span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>],</span><br><span class="line">    [<span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>],</span><br><span class="line">    [<span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>],</span><br><span class="line">    [<span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>],</span><br><span class="line">    [<span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>],</span><br><span class="line">    [<span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>],</span><br><span class="line">    [<span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>],</span><br><span class="line">    [<span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>],</span><br><span class="line">    [<span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>],</span><br><span class="line">    [<span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>],</span><br><span class="line">    [<span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>],</span><br><span class="line">    [<span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>],</span><br><span class="line">    [<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>],</span><br><span class="line">    [<span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>],</span><br><span class="line">    [<span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>4.3 轮常数（RC）</p>
<p>用于密钥扩展，控制每一轮轮密钥的生成。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rc = [<span class="number">0x12</span>, <span class="number">0x23</span>, <span class="number">0x34</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x67</span>, <span class="number">0x78</span>, <span class="number">0x89</span>, <span class="number">0x9a</span>, <span class="number">0xab</span>, <span class="number">0xbc</span>, <span class="number">0xcd</span>, <span class="number">0xde</span>, <span class="number">0xef</span>, <span class="number">0xf1</span>]</span><br></pre></td></tr></table></figure>

<p><strong>5. 核心解密函数实现（含中文注释）</strong></p>
<p>5.1 伽罗瓦域（GF (2⁸)）乘法</p>
<p>AES 的<code>mix_columns</code>和<code>inv_mix_columns</code>依赖 GF (2⁸) 域上的乘法，此处实现标准伽罗瓦域乘法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gmul</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    GF(2^8)域上的乘法运算，AES逆列混合操作的核心</span></span><br><span class="line"><span class="string">    :param a: 乘数1（字节）</span></span><br><span class="line"><span class="string">    :param b: 乘数2（字节）</span></span><br><span class="line"><span class="string">    :return: 乘法结果（字节，模0x11b）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    p = <span class="number">0</span>  <span class="comment"># 结果初始化为0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> b &amp; <span class="number">1</span>:  <span class="comment"># 若b的当前最低位为1，将a累加到结果</span></span><br><span class="line">            p ^= a</span><br><span class="line">        high = a &amp; <span class="number">0x80</span>  <span class="comment"># 检查a的最高位（第8位）是否为1</span></span><br><span class="line">        a = (a &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xff</span>  <span class="comment"># a左移1位，保留低8位</span></span><br><span class="line">        <span class="keyword">if</span> high:  <span class="comment"># 若最高位为1，异或模多项式0x1b（AES标准）</span></span><br><span class="line">            a ^= <span class="number">0x1b</span></span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>  <span class="comment"># b右移1位，处理下一位</span></span><br><span class="line">    <span class="keyword">return</span> p &amp; <span class="number">0xff</span>  <span class="comment"># 确保结果为8位字节</span></span><br></pre></td></tr></table></figure>

<p>5.2 逆字节代换（inv_sub_bytes）</p>
<p>通过逆 S 盒将字节代换的结果还原，是<code>sub_bytes</code>的逆操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    逆字节代换：将输入字节数组中的每个字节通过逆S盒映射为原始字节</span></span><br><span class="line"><span class="string">    :param grid: 输入字节数组（16字节，对应AES的1个数据块）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(grid):</span><br><span class="line">        <span class="comment"># 高4位作为逆S盒的行索引，低4位作为列索引</span></span><br><span class="line">        grid[i] = s_box_inv[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0xf</span>]</span><br></pre></td></tr></table></figure>

<p>5.3 逆列混合（inv_mix_columns）</p>
<p>还原<code>mix_columns</code>的操作，通过伽罗瓦域乘法调整每列的 4 个字节，是 AES 解密的核心步骤之一。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    逆列混合：还原列混合操作，对每个4字节列执行GF(2^8)域上的线性变换</span></span><br><span class="line"><span class="string">    :param grid: 输入字节数组（16字节，按列划分为4个4字节列）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 遍历每个4字节列（步长为4）</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">4</span>):</span><br><span class="line">        a = grid[i:i+<span class="number">4</span>]  <span class="comment"># 提取当前列的4个字节</span></span><br><span class="line">        <span class="comment"># 按AES标准逆列混合公式计算（乘数为14、11、13、9）</span></span><br><span class="line">        grid[i]   = gmul(a[<span class="number">0</span>], <span class="number">14</span>) ^ gmul(a[<span class="number">1</span>], <span class="number">11</span>) ^ gmul(a[<span class="number">2</span>], <span class="number">13</span>) ^ gmul(a[<span class="number">3</span>], <span class="number">9</span>)</span><br><span class="line">        grid[i+<span class="number">1</span>] = gmul(a[<span class="number">0</span>], <span class="number">9</span>)  ^ gmul(a[<span class="number">1</span>], <span class="number">14</span>) ^ gmul(a[<span class="number">2</span>], <span class="number">11</span>) ^ gmul(a[<span class="number">3</span>], <span class="number">13</span>)</span><br><span class="line">        grid[i+<span class="number">2</span>] = gmul(a[<span class="number">0</span>], <span class="number">13</span>) ^ gmul(a[<span class="number">1</span>], <span class="number">9</span>)  ^ gmul(a[<span class="number">2</span>], <span class="number">14</span>) ^ gmul(a[<span class="number">3</span>], <span class="number">11</span>)</span><br><span class="line">        grid[i+<span class="number">3</span>] = gmul(a[<span class="number">0</span>], <span class="number">11</span>) ^ gmul(a[<span class="number">1</span>], <span class="number">13</span>) ^ gmul(a[<span class="number">2</span>], <span class="number">9</span>)  ^ gmul(a[<span class="number">3</span>], <span class="number">14</span>)</span><br></pre></td></tr></table></figure>

<p>5.4 轮密钥加（add_round_key）</p>
<p>将数据块与当前轮的轮密钥进行异或操作，是加密和解密中均需执行的步骤（可逆）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">grid, round_key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    轮密钥加：将数据块与轮密钥逐字节异或，实现密钥与数据的混合</span></span><br><span class="line"><span class="string">    :param grid: 数据块（16字节）</span></span><br><span class="line"><span class="string">    :param round_key: 当前轮的轮密钥（16字节）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        grid[i] ^= round_key[i]</span><br></pre></td></tr></table></figure>

<p>5.5 密钥扩展（key_expansion）</p>
<p>将原始密钥（32 字节，AES-256）扩展为多轮轮密钥（共 11 轮，每轮 16 字节，总计 176 字节），供解密时使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">key_expansion</span>(<span class="params">grid</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    密钥扩展：将原始密钥扩展为多轮轮密钥，满足AES-256的11轮加密需求</span></span><br><span class="line"><span class="string">    :param grid: 原始密钥（字节数组，32字节）</span></span><br><span class="line"><span class="string">    :return: 扩展后的轮密钥（字节数组，176字节）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 扩展10轮（AES-256共11轮，原始密钥为第0轮，需再生成10轮）</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span> * <span class="number">4</span>):</span><br><span class="line">        r = grid[-<span class="number">4</span>:]  <span class="comment"># 取最后4字节（用于生成新密钥片段）</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:  <span class="comment"># 每4个片段（16字节）执行一次字节代换和循环移位</span></span><br><span class="line">            <span class="comment"># 循环移位：将r的后3字节与第1字节交换（如[r0,r1,r2,r3]→[r1,r2,r3,r0]）</span></span><br><span class="line">            shifted_r = r[<span class="number">1</span>:] + r[:<span class="number">1</span>]</span><br><span class="line">            <span class="comment"># 字节代换：通过S盒映射，并在第1字节异或当前轮常数</span></span><br><span class="line">            <span class="keyword">for</span> j, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(shifted_r):</span><br><span class="line">                r[j] = s_box[v &gt;&gt; <span class="number">4</span>][v &amp; <span class="number">0xf</span>] ^ (rc[i // <span class="number">4</span>] <span class="keyword">if</span> j == <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 生成新密钥片段：与16字节前的片段异或</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            grid.append(grid[-<span class="number">16</span>] ^ r[j])</span><br><span class="line">    <span class="keyword">return</span> grid</span><br></pre></td></tr></table></figure>

<p>5.6 单块解密（decrypt_block）</p>
<p>处理单个 16 字节数据块的解密逻辑，严格逆向加密流程（含<code>shift_rows</code>空操作的处理）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">block, expanded_key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    单块解密：对16字节的密文块执行完整解密流程</span></span><br><span class="line"><span class="string">    :param block: 密文块（16字节）</span></span><br><span class="line"><span class="string">    :param expanded_key: 扩展后的轮密钥（176字节）</span></span><br><span class="line"><span class="string">    :return: 明文块（16字节）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    b = <span class="built_in">bytearray</span>(block)  <span class="comment"># 转换为可修改的字节数组</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. 最后一轮逆向：轮密钥加（用最后一轮密钥）→ 逆字节代换（因shift_rows空操作，省略逆行移位）</span></span><br><span class="line">    add_round_key(b, expanded_key[-<span class="number">16</span>:])  <span class="comment"># 最后一轮密钥：扩展密钥的最后16字节</span></span><br><span class="line">    inv_sub_bytes(b)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 中间9轮逆向：轮密钥加 → 逆列混合 → 逆字节代换（省略逆行移位）</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, <span class="number">0</span>, -<span class="number">1</span>):  <span class="comment"># 从第9轮倒序到第1轮</span></span><br><span class="line">        add_round_key(b, expanded_key[i*<span class="number">16</span>: (i+<span class="number">1</span>)*<span class="number">16</span>])  <span class="comment"># 当前轮密钥（第i轮）</span></span><br><span class="line">        inv_mix_columns(b)  <span class="comment"># 逆列混合</span></span><br><span class="line">        inv_sub_bytes(b)    <span class="comment"># 逆字节代换</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 初始轮逆向：轮密钥加（用第0轮密钥）</span></span><br><span class="line">    add_round_key(b, expanded_key[:<span class="number">16</span>])  <span class="comment"># 第0轮密钥：扩展密钥的前16字节</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(b)</span><br></pre></td></tr></table></figure>

<p>5.7 完整解密（decrypt）</p>
<p>处理任意长度的密文，按 16 字节分块解密，最后拼接结果并返回明文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    完整解密：对任意长度的密文分块解密，返回明文</span></span><br><span class="line"><span class="string">    :param ciphertext: 待解密密文（字节串）</span></span><br><span class="line"><span class="string">    :param key: 解密密钥（字节串，32字节，AES-256）</span></span><br><span class="line"><span class="string">    :return: 明文（字节串）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. 扩展密钥：将原始密钥转换为轮密钥</span></span><br><span class="line">    expanded_key = key_expansion(<span class="built_in">bytearray</span>(key))</span><br><span class="line">    <span class="comment"># 2. 转换密文为字节数组，便于分块处理</span></span><br><span class="line">    cipher_bytes = <span class="built_in">bytearray</span>(ciphertext)</span><br><span class="line">    <span class="comment"># 3. 分块解密：每16字节为一个块</span></span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher_bytes), <span class="number">16</span>):</span><br><span class="line">        <span class="comment"># 提取当前块（不足16字节时取剩余部分，实际AES密文应为16字节整数倍）</span></span><br><span class="line">        block = cipher_bytes[i:i+<span class="number">16</span>]</span><br><span class="line">        <span class="comment"># 解密当前块并追加到明文</span></span><br><span class="line">        plaintext.extend(decrypt_block(block, expanded_key))</span><br><span class="line">    <span class="comment"># 4. 转换为字节串返回（可根据需求解码为字符串，如latin1或utf-8）</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义密钥和密文</span></span><br><span class="line">key = <span class="string">b&#x27;Slightly different from the AES.&#x27;</span></span><br><span class="line">cipher = <span class="string">b&#x27;%\x98\x10\x8b\x93O\xc7\xf02F\xae\xedA\x96\x1b\xf9\x9d\x96\xcb\x8bT\r\xd31P\xe6\x1a\xa1j\x0c\xe6\xc8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行解密</span></span><br><span class="line">plaintext = decrypt(cipher, key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果（解码为latin1，避免非ASCII字符报错）</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的明文（字节串）：&quot;</span>, plaintext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的明文（字符串）：&quot;</span>, plaintext.decode(<span class="string">&#x27;latin1&#x27;</span>))</span><br></pre></td></tr></table></figure>

<ol start="6">
<li><p>关键说明</p>
</li>
<li><p><strong><code>shift_rows</code>漏洞的处理</strong>：由于加密时<code>shift_rows</code>未生效（空操作），解密时未实现<code>inv_shift_rows</code>函数，直接省略该步骤，确保解密逻辑与加密逻辑一致。</p>
</li>
<li><p><strong>逆 S 盒的修正</strong>：原始代码中<code>inv_sub_bytes</code>的<code>0xff</code>对应值误写为<code>0</code>，修正为正确的<code>0x87</code>后，解密结果才符合预期。</p>
</li>
<li><p><strong>编码选择</strong>：解密后的明文含非 ASCII 填充字节（如<code>\x00</code>），使用<code>latin1</code>解码可避免报错，若为纯 ASCII flag，也可使用<code>utf-8</code>解码（需先去除填充）。</p>
</li>
</ol>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h3 id="入门指北-1"><a href="#入门指北-1" class="headerlink" title="入门指北"></a>入门指北</h3><p>进行JSfuck解码即可获得flag</p>
<h3 id="第一章神秘的手镯"><a href="#第一章神秘的手镯" class="headerlink" title="第一章神秘的手镯"></a>第一章神秘的手镯</h3><p>（附件没用的……）</p>
<p>重点在于神念探查可窥天机</p>
<p>F12打开源代码获得flag</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250811111451158.png" alt="image-20250811111451158"></p>
<h3 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h3><p>打开源码发现</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250811112221457.png" alt="image-20250811112221457"></p>
<p>访问&#x2F;golden_trail</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250811112249264.png" alt="image-20250811112249264"></p>
<p>哈哈</p>
<p>wireshark截获http请求（省流）</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250811120044005.png" alt="image-20250811120044005"></p>
<p>此段http请求……分级都打开会发现一长串数据（好奇打开发现flag</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250811120221565.png" alt="image-20250811120221565"></p>
<p>右键追踪http流 可复制<br><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250811120315933.png" alt="image-20250811120315933"></p>
<h3 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h3><p>抓包</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817104027595.png" alt="image-20250817104027595"></p>
<p>修改请求得到flag</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817104153546.png" alt="image-20250817104153546"></p>
<h3 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h3><p>题目关键</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250822235801346.png" alt="image-20250822235801346"></p>
<p><strong>第一关</strong></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817172811097.png" alt="image-20250817172811097"></p>
<p>添加key</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817173537249.png" alt="image-20250817173537249"></p>
<p>获得玉简碎片: bW9lY3Rme0Mw</p>
<p><strong>第二关发送</strong>post请求</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817224010889.png" alt="image-20250817224010889"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817231922341.png" alt="image-20250817231922341"></p>
<p>获得玉简碎片: bjZyNDd1MTQ3</p>
<p><strong>第三关</strong></p>
<p>显示本地访问，这里抓包修改</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817232503560.png" alt="image-20250817232503560"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817233810469.png" alt="image-20250817233810469"></p>
<p>获得玉简碎片: MTBuNV95MHVy</p>
<p><strong>第四关</strong></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817233953313.png" alt="image-20250817233953313"></p>
<p>把光标处的浏览器改成moe browser即可</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817234141994.png" alt="image-20250817234141994"></p>
<p>获得玉简碎片: X2g3N1BfbDN2</p>
<p><strong>第五关</strong></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817234251591.png" alt="image-20250817234251591"></p>
<p>添加user&#x3D;xt发送请求得到</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817234520888.png" alt="image-20250817234520888"></p>
<p>获得玉简碎片: M2xfMTVfcjM0</p>
<p><strong>第六关</strong></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817234615610.png" alt="image-20250817234615610"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817235552677.png" alt="image-20250817235552677"></p>
<p>获得玉简碎片: bGx5X2gxOWgh</p>
<p><strong>第七关</strong></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817235706161.png" alt="image-20250817235706161"></p>
<p>postman在raw出传输文本得到</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818000526409.png" alt="image-20250818000526409"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818000502088.png" alt="image-20250818000502088"></p>
<p>获得玉简碎片: fQ&#x3D;&#x3D;</p>
<p>碎片拼到一起进行base解码bW9lY3Rme0MwbjZyNDd1MTQ3MTBuNV95MHVyX2g3N1BfbDN2M2xfMTVfcjM0bGx5X2gxOWghfQ&#x3D;&#x3D;</p>
<h3 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h3><p>第一页只有一个文件夹点进去观察页面</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817103344113.png" alt="image-20250817103344113"></p>
<p>使用&#x2F;..访问上级目录</p>
<p>使用&#x2F;..进行访问</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817103438354.png" alt="image-20250817103438354"></p>
<p>继续访问上级目录直到发现flag文件</p>
<p><img src="C:\Users\Ling\AppData\Roaming\Typora\typora-user-images\image-20250817103629483.png" alt="image-20250817103629483"></p>
<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825161822745.png" alt="image-20250825161822745" style="zoom:80%;" />

<h3 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a><strong>第六章</strong></h3><p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818001351846.png" alt="image-20250818001351846"></p>
<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818001741914.png" alt="image-20250818001741914" style="zoom:80%;" />

<h3 id="第七章"><a href="#第七章" class="headerlink" title="第七章"></a>第七章</h3><p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817153353877.png" alt="image-20250817153353877"></p>
<p>纯文本法诀，尝试访问robots.txt</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817153514515.png" alt="image-20250817153514515"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817153536618.png" alt="image-20250817153536618"></p>
<p>根据代码得知a≠b a和b的md5要相同，让我们请出豆包战神<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817154600987.png" alt="image-20250817154600987" style="zoom:80%;" /></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817154414188.png" alt="image-20250817154414188"></p>
<h3 id="第九章"><a href="#第九章" class="headerlink" title="第九章"></a>第九章</h3><p>按照提示输入后显示</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250819142757507.png" alt="image-20250819142757507"></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250819142704144.png" alt="image-20250819142704144"></p>
<p>输入;ls回显index.php</p>
<p>输入;env（显示所有环境变量）回显得到flag</p>
<p>（;dir 有回显是Windows系统  ;env 有回显是Linux系统）</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250822230821782.png" alt="image-20250822230821782"></p>
<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825161054406.png" alt="image-20250825161054406" style="zoom:80%;" />

<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825162040594.png" alt="image-20250825162040594" style="zoom:80%;" />

<h3 id="第十章（非预期解）"><a href="#第十章（非预期解）" class="headerlink" title="第十章（非预期解）"></a>第十章（非预期解）</h3><p>根据提示直接访问&#x2F;flag.txt</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818231847872.png" alt="image-20250818231847872"></p>
<h3 id="第十章（预期解"><a href="#第十章（预期解" class="headerlink" title="第十章（预期解)"></a>第十章（预期解)</h3><p><strong>根据回显猜测是XXE攻击</strong></p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250824225449425.png" alt="image-20250824225449425"></p>
<p>构造Playload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">    &lt;!ENTITY flag SYSTEM &quot;file:///flag.txt&quot;&gt;  &lt;!-- 定义外部实体，指向远程文件 --&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;天机契约&gt;</span><br><span class="line">    &lt;阵枢&gt;引魂玉&lt;/阵枢&gt;</span><br><span class="line">    &lt;解析&gt;flag: &amp;flag;&lt;/解析&gt;  &lt;!-- 引用实体 --&gt;</span><br><span class="line">&lt;/天机契约&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250824225921537.png" alt="image-20250824225921537"></p>
<p>得到flag（具体知识点在笔记里）</p>
<h3 id="第十一章"><a href="#第十一章" class="headerlink" title="第十一章"></a>第十一章</h3><p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825123431407.png" alt="image-20250825123431407"></p>
<p>先搞个脚本生成一下所有排列结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义要排列的字母</span></span><br><span class="line">letters = [<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成所有排列并打印，每个排列单独一行</span></span><br><span class="line"><span class="keyword">for</span> perm <span class="keyword">in</span> permutations(letters):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(perm))</span><br></pre></td></tr></table></figure>

<p>参数值&#x3D;参数名 bp抓包构造playload</p>
<p>进行爆破发现有一条长度很不一样，访问flag.php（这里是文件包含漏洞……现学现卖……在笔记里）</p>
<p>对话框访问php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825131615380.png" alt="image-20250825131615380"></p>
<p>打开……</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825131725301.png" alt="image-20250825131725301"></p>
<p>对话框访问php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php进行base解码</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825144822444.png" alt="image-20250825144822444"></p>
<p>补充：</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250825160534501.png" alt="image-20250825160534501"></p>
<h3 id="第十二章"><a href="#第十二章" class="headerlink" title="第十二章"></a>第十二章</h3><p>打开发现</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818234442397.png" alt="image-20250818234442397"></p>
<p>根据提示使用蚁剑连接</p>
<p> $_POST[‘cmd’] 表示从 POST 请求中获取名为 cmd 的参数值并执行，所以蚁剑连接时，“连接密码” 填 cmd，才能让工具和木马的参数名匹配，实现命令传输（比如蚁剑发 cmd&#x3D;system(‘ls’);，代码就会执行 system(‘ls’)）。</p>
<p>简单说：代码里写了 cmd 作为接收命令的参数，所以连接时必须填 cmd 才能对应上，是代码逻辑里约定好的参数名</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818235939925.png" alt="image-20250818235939925"></p>
<p>用虚拟终端输入env查找flag（通过 env 命令列出所有环境变量）</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818235127963.png" alt="image-20250818235127963"></p>
<h3 id="第十三章"><a href="#第十三章" class="headerlink" title="第十三章"></a>第十三章</h3><p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250819162522092.png"></p>
<p>文件上传漏洞</p>
<p>用<?php print_r(scandir('.')); ?>构造木马文件图片（在jpg文件用010打开在后边添加这句话）</p>
<p>进行上传抓包，把jpg后缀改成php发送请求</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250820135141393.png" alt="image-20250820135141393"></p>
<p>使用蚁剑连接，打开根目录发现flag.txt</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250820135454401.png" alt="image-20250820135454401"></p>
<h3 id="猜数字"><a href="#猜数字" class="headerlink" title="猜数字"></a>猜数字</h3><p>打开源码发现</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250817104834170.png" alt="image-20250817104834170"></p>
<p>访问&#x2F;flag失败，本地post一下获得flag</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250818002130396.png" alt="image-20250818002130396"></p>
<h3 id="摸金偶遇FLAG，拼尽全力难战胜"><a href="#摸金偶遇FLAG，拼尽全力难战胜" class="headerlink" title="摸金偶遇FLAG，拼尽全力难战胜"></a><strong>摸金偶遇FLAG，拼尽全力难战胜</strong></h3><p>豆包脚本</p>
<p>版本1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">BASE_URL = <span class="string">&quot;http://127.0.0.1:52825&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 初始化会话，保持Cookie</span></span><br><span class="line">    session = requests.Session()</span><br><span class="line">    session.headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 1. 获取挑战数据</span></span><br><span class="line">        res = session.get(<span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/get_challenge?count=9&quot;</span>)</span><br><span class="line">        res.raise_for_status()  <span class="comment"># 检查请求是否成功</span></span><br><span class="line">        data = res.json()</span><br><span class="line">        real_code = data[<span class="string">&quot;numbers&quot;</span>]</span><br><span class="line">        token = data[<span class="string">&quot;token&quot;</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;获取题目成功：<span class="subst">&#123;real_code&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 提交答案</span></span><br><span class="line">        res = session.post(</span><br><span class="line">            <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/verify&quot;</span>,</span><br><span class="line">            data=json.dumps(&#123;<span class="string">&quot;answers&quot;</span>: real_code, <span class="string">&quot;token&quot;</span>: token&#125;)</span><br><span class="line">        )</span><br><span class="line">        res.raise_for_status()</span><br><span class="line">        result = res.json()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 输出结果</span></span><br><span class="line">        <span class="keyword">if</span> result[<span class="string">&quot;correct&quot;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;成功！FLAG: <span class="subst">&#123;result[<span class="string">&#x27;flag&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;失败：<span class="subst">&#123;result[<span class="string">&#x27;message&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;出错了：<span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250824234420569.png" alt="image-20250824234420569" style="zoom:80%;" />

<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250824234443324.png" alt="image-20250824234443324" style="zoom:80%;" />

<p>版本2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">r = s.get(<span class="string">&quot;http://127.0.0.1:52825/get_challenge?count=9&quot;</span>).json()</span><br><span class="line">res = s.post(<span class="string">&quot;http://127.0.0.1:52825/verify&quot;</span>,</span><br><span class="line">             json=&#123;<span class="string">&quot;answers&quot;</span>: r[<span class="string">&quot;numbers&quot;</span>], <span class="string">&quot;token&quot;</span>: r[<span class="string">&quot;token&quot;</span>]&#125;).json()</span><br><span class="line"><span class="built_in">print</span>(res[<span class="string">&quot;flag&quot;</span>] <span class="keyword">if</span> res[<span class="string">&quot;correct&quot;</span>] <span class="keyword">else</span> res[<span class="string">&quot;message&quot;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250824234209052.png" alt="image-20250824234209052" style="zoom:80%;" />

<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="入门指北-2"><a href="#入门指北-2" class="headerlink" title="入门指北"></a>入门指北</h3><p>IDA打开附件根据提示shift+F12即可</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250809150740247.png" alt="image-20250809150740247"></p>
<h3 id="base"><a href="#base" class="headerlink" title="base"></a>base</h3><p>IDA打开看到base编码尝试解码得到flag</p>
<p><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/image-20250816134339778.png" alt="image-20250816134339778"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.qvq-ling.online">QvQ-Ling</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.qvq-ling.online/uncategorized/moectf2025/">https://www.qvq-ling.online/uncategorized/moectf2025/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.qvq-ling.online" target="_blank">QvQ-Ling</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/uncategorized/Tools/" title="Tools_WIndows"><img class="cover" src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/share_2001b771116ec4f0bbaae8c633e95ba6.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Tools_WIndows</div></div><div class="info-2"><div class="info-item-1">SSTV decoder1sstv -d file+place -o result.png    upx脱壳 1upx -d file_place  </div></div></div></a><a class="pagination-related" href="/uncategorized/hello-world/" title="Hello World"><img class="cover" src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/IMG_20240921_205509.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">QvQ-Ling</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%82%E4%BD%8F%E4%B8%80%E5%8F%AA%E8%80%B3"><span class="toc-number">1.1.</span> <span class="toc-text">捂住一只耳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-LSB"><span class="toc-number">1.2.</span> <span class="toc-text">ez_LSB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-PNG"><span class="toc-number">1.3.</span> <span class="toc-text">ez_PNG</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enchantment"><span class="toc-number">1.4.</span> <span class="toc-text">Enchantment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sstv"><span class="toc-number">1.5.</span> <span class="toc-text">sstv</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rush"><span class="toc-number">1.6.</span> <span class="toc-text">Rush</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-%E9%94%9F%E6%96%A4%E6%8B%B7"><span class="toc-number">1.7.</span> <span class="toc-text">ez_锟斤拷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#encrypted-pdf"><span class="toc-number">1.8.</span> <span class="toc-text">encrypted_pdf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-ssl"><span class="toc-number">1.9.</span> <span class="toc-text">ez_ssl</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">2.0.1.</span> <span class="toc-text">入门指北</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-DES"><span class="toc-number">2.0.2.</span> <span class="toc-text">ez_DES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-square"><span class="toc-number">2.0.3.</span> <span class="toc-text">ez_square</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezlegendre"><span class="toc-number">2.0.4.</span> <span class="toc-text">ezlegendre</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-next"><span class="toc-number">2.0.5.</span> <span class="toc-text">baby_next</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezBSGS"><span class="toc-number">2.0.6.</span> <span class="toc-text">ezBSGS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#happyRSA"><span class="toc-number">2.0.7.</span> <span class="toc-text">happyRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-aes"><span class="toc-number">2.0.8.</span> <span class="toc-text">ez_aes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">2.0.9.</span> <span class="toc-text"></span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-1"><span class="toc-number">3.0.1.</span> <span class="toc-text">入门指北</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%E7%A5%9E%E7%A7%98%E7%9A%84%E6%89%8B%E9%95%AF"><span class="toc-number">3.0.2.</span> <span class="toc-text">第一章神秘的手镯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0"><span class="toc-number">3.0.3.</span> <span class="toc-text">第二章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0"><span class="toc-number">3.0.4.</span> <span class="toc-text">第三章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0"><span class="toc-number">3.0.5.</span> <span class="toc-text">第四章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0"><span class="toc-number">3.0.6.</span> <span class="toc-text">第五章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0"><span class="toc-number">3.0.7.</span> <span class="toc-text">第六章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0"><span class="toc-number">3.0.8.</span> <span class="toc-text">第七章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0"><span class="toc-number">3.0.9.</span> <span class="toc-text">第九章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0%EF%BC%88%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3%EF%BC%89"><span class="toc-number">3.0.10.</span> <span class="toc-text">第十章（非预期解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0%EF%BC%88%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">3.0.11.</span> <span class="toc-text">第十章（预期解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0"><span class="toc-number">3.0.12.</span> <span class="toc-text">第十一章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0"><span class="toc-number">3.0.13.</span> <span class="toc-text">第十二章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0"><span class="toc-number">3.0.14.</span> <span class="toc-text">第十三章</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8C%9C%E6%95%B0%E5%AD%97"><span class="toc-number">3.0.15.</span> <span class="toc-text">猜数字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%B8%E9%87%91%E5%81%B6%E9%81%87FLAG%EF%BC%8C%E6%8B%BC%E5%B0%BD%E5%85%A8%E5%8A%9B%E9%9A%BE%E6%88%98%E8%83%9C"><span class="toc-number">3.0.16.</span> <span class="toc-text">摸金偶遇FLAG，拼尽全力难战胜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">3.1.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97-2"><span class="toc-number">3.1.1.</span> <span class="toc-text">入门指北</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base"><span class="toc-number">3.1.2.</span> <span class="toc-text">base</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/uncategorized/Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="无标题"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945684510.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无标题"/></a><div class="content"><a class="title" href="/uncategorized/Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="无标题">无标题</a><time datetime="2025-08-14T02:18:54.522Z" title="发表于 2025-08-14 10:18:54">2025-08-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/uncategorized/%E8%8F%9C%E7%8B%97%E6%9D%AF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="菜狗杯刷题记录"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945678160.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="菜狗杯刷题记录"/></a><div class="content"><a class="title" href="/uncategorized/%E8%8F%9C%E7%8B%97%E6%9D%AF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="菜狗杯刷题记录">菜狗杯刷题记录</a><time datetime="2025-08-13T16:00:00.000Z" title="发表于 2025-08-14 00:00:00">2025-08-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/uncategorized/Tools/" title="Tools_WIndows"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/share_2001b771116ec4f0bbaae8c633e95ba6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Tools_WIndows"/></a><div class="content"><a class="title" href="/uncategorized/Tools/" title="Tools_WIndows">Tools_WIndows</a><time datetime="2025-08-08T16:00:00.000Z" title="发表于 2025-08-09 00:00:00">2025-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/uncategorized/moectf2025/" title="无标题"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无标题"/></a><div class="content"><a class="title" href="/uncategorized/moectf2025/" title="无标题">无标题</a><time datetime="2025-08-08T16:00:00.000Z" title="发表于 2025-08-09 00:00:00">2025-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/uncategorized/hello-world/" title="Hello World"><img src="https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/qq_pic_merged_1731945706915.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/uncategorized/hello-world/" title="Hello World">Hello World</a><time datetime="2025-06-20T14:52:06.507Z" title="发表于 2025-06-20 22:52:06">2025-06-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://lingc-1331223348.cos.ap-chengdu.myqcloud.com/d1ce098342204908174c743577640017.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By QvQ-Ling</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'RAF5WiARHber2ob8Mp5cCIjM-MdYXbMMI',
      appKey: 'SlcDkXmqL4H9LPaBJlQoAYwO',
      avatar: 'monsterid',
      serverURLs: 'https://www.qvq-ling.online',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>